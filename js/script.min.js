function generateUUID(){var a=(new Date).getTime();window.performance&&"function"==typeof window.performance.now&&(a+=performance.now());var b="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(b){var c=(a+16*Math.random())%16|0;return a=Math.floor(a/16),("x"==b?c:3&c|8).toString(16)});return b}function getPlayersFromLocalStorage(){if(localStorage.players_list){for(var a=Array(),b=JSON.parse(localStorage.players_list),c=0;c<b.length;c++){var d=new Player(b[c]);a.push(d)}return a.sort(sortByNames),a}return localStorage.players_list="[]",Array()}function getTournamentsFromLocalStorage(a){if(localStorage.tournaments_list){for(var b=Array(),c=JSON.parse(localStorage.tournaments_list),d=0;d<c.length;d++){var e=new Tournament(c[d]);b.push(e)}return b}return localStorage.tournaments_list="[]",Array()}function savePlayersToLocalStorage(a){a.sort(sortByNames),localStorage.players_list=JSON.stringify(a)}function saveTournamentsToLocalStorage(a,b){for(var c=0;c<a.length;c++)a[c].playerObjs&&delete a[c].playerObjs,a[c].matchupObjs&&delete a[c].matchupObjs;localStorage.tournaments_list=JSON.stringify(a);for(var c=0;c<a.length;c++)a[c].createPlayerObjs(b),a[c].createMatchupObjs(b)}function getPlayerByID(a,b){for(var c=0;c<a.length;c++)if(a[c].id==b)return a[c];return null}function getStyledPlayerName(a){return a.name.nick?a.name.first+'"<strong>'+a.name.nick+'</strong>"'+a.name.last:"<strong>"+a.first+"</strong>"+a.name.last}function getPlayerIndexByID(a,b){for(var c=0;c<a.length;c++)if(a[c].id==b)return c;return-1}function getNextPlayerID(a){maxID=0;for(var b=0;b<a.length;b++)a[b].id>maxID&&(maxID=a[b].id);return maxID+1}function sortByNames(a,b){return a.name.last<b.name.last?-1:a.name.last>b.name.last?1:a.name.first<b.name.first?-1:a.name.first>b.name.first?1:a.name.nick<b.name.nick?-1:a.name.nick>b.name.nick?1:0}function sortByBaseScore(a,b){return a.pointsBase>b.pointsBase?-1:a.pointsBase<b.pointsBase?1:0}function sortByFinalScore(a,b){return a.pointsFinal>b.pointsFinal?-1:a.pointsFinal<b.pointsFinal?1:0}function steamPlayerSort(a,b){return a.pointsBase>b.pointsBase?-1:a.pointsBase<b.pointsBase?1:a.steamControlPoints>b.steamControlPoints?-1:a.steamControlPoints<b.steamControlPoints?1:a.steamArmyPoints>b.steamArmyPoints?-1:a.steamArmyPoints<b.steamArmyPoints?1:0}function formatDate(a){var b=require("dateformat");return b(a,"dddd, mmmm dS, yyyy, h:MM:ss TT")}function shuffleArray(a){for(var b,c,d=a.length;0!==d;)c=Math.floor(Math.random()*d),d-=1,b=a[d],a[d]=a[c],a[c]=b;return a}function Player(a){this.name={first:"",last:"",nick:""},this.email="",this.phone1="",this.created=new Date,this.updated=new Date,this.active=!0,this.deleted=!1,this.id=-1,"undefined"!=typeof a&&("undefined"!=typeof a.email&&(this.name={first:a.name.first.trim(),last:a.name.last.trim(),nick:a.name.nick.trim()}),"undefined"!=typeof a.created&&(this.created=new Date(a.created)),"undefined"!=typeof a.updated&&(this.updated=new Date(a.updated)),"undefined"!=typeof a.email&&(this.email=a.email),"undefined"!=typeof a.phone1&&(this.phone1=a.phone1),"undefined"!=typeof a.active&&(this.active=a.active),"undefined"!=typeof a.deleted&&(this.deleted=a.deleted),"undefined"!=typeof a.id&&(this.id=a.id)),this.newFunction=function(){}}function Tournament(a,b){this.players=Array(),this.playerObjs=Array(),this.name="",this.numberOfRounds=4,this.pointsForWin=2,this.pointsForDraw=1,this.pointsForLoss=0,this.pointsForBye=1,this.type="swiss",this.byeIsAverage=!0,this.scoringPaint=!1,this.scoringComp=!1,this.scoringSportsmanship=!1,this.created=new Date,this.updated=new Date,this.completed=!1,this.trackPerGameSportsmanship=!0,this.warnSportsmanship=2,this.scoring=Array(),this.extraPoints=Array(),this.steamControlPoints=Array(),this.steamArmyPoints=Array(),this.pointsPainting=Array(),this.pointsComposition=Array(),this.pointsSportsmanship=Array(),this.currentRound=0,this.matches=Array(),this.noDuplicateMatchups=!0,this.matchupType="highest-ranking",this.swapLog="",this.createMatchupObjs=function(a){this.matchupObjs=Array();for(var b in this.matches)if(this.matchupObjs[b]=Array(),this.matches[b])for(var c=0;c<this.matches[b].length;c++){var d={table:this.matches[b][c].table,player1:getPlayerByID(a,this.matches[b][c].player1),player2:getPlayerByID(a,this.matches[b][c].player2)};this.matchupObjs[b].push(d)}},this.attemptToRemoveDuplicateMatches=function(a,b){if(0==this.noDuplicateMatchups)return!1;this.swapLog="<ul>";for(var c=null,d=null,e=0;e<this.matches[a].length;e++)if(this.hasPlayedEachOther(this.matches[a][e].player1,this.matches[a][e].player2)){c=getPlayerByID(b,this.matches[a][e].player1),d=getPlayerByID(b,this.matches[a][e].player2),this.swapLog+="<li>"+getStyledPlayerName(c)+" has played "+getStyledPlayerName(d)+"</li>\n";for(var f=e+1;f<this.matches[a].length;f++){if(!this.hasPlayedEachOther(this.matches[a][f].player1,this.matches[a][e].player1)){swapPlayer=getPlayerByID(b,this.matches[a][f].player1),origID=this.matches[a][e].player2,this.matches[a][e].player2=this.matches[a][f].player1,this.matches[a][f].player1=origID,this.swapLog+="<li><strong>SWAPPING</strong> "+getStyledPlayerName(d)+" with "+getStyledPlayerName(swapPlayer)+"</li>\n";break}if(!this.hasPlayedEachOther(this.matches[a][f].player2,this.matches[a][e].player1)){swapPlayer=getPlayerByID(b,this.matches[a][f].player1),origID=this.matches[a][e].player1,this.matches[a][e].player1=this.matches[a][f].player2,this.matches[a][f].player2=origID,this.swapLog+="<li><strong>SWAPPING</strong> "+getStyledPlayerName(c)+" with "+getStyledPlayerName(swapPlayer)+"</li>\n";break}}}"<ul>"==this.swapLog?this.swapLog="":this.swapLog+="</ul>"},this.createMatchRound=function(a,b){this.createPlayerObjs(b);Array();this.matches[a]=Array(),"highest-ranking"==this.matchupType?this.sortPlayerObjsByScores():"random"==this.matchupType?this.playerObjs=shuffleArray(this.playerObjs):this.sortPlayerObjsByScores();var c=0,d=1,e=!1;if(this.playerObjs.length%2==0)for(;c<this.playerObjs.length;){var f={table:d,player1:this.playerObjs[c].id,player2:this.playerObjs[c+1].id};this.matches[a].push(f),d++,c+=2}else{for(var g=(this.playerObjs.length-1)/2;this.hasHadBye(this.playerObjs[g].id);)g++;for(var h=0,i=0;c<this.playerObjs.length;){if(g==c?(h=this.playerObjs[c].id,i=-1,e=!0):0==h?h=this.playerObjs[c].id:0==i&&(i=this.playerObjs[c].id),0!=h&&0!=i){var f={table:d,player1:h,player2:i};this.matches[a].push(f),h=0,i=0,d++}c++}}this.attemptToRemoveDuplicateMatches(a,b),this.createMatchupObjs(b)},this.getScore=function(a,b){return"undefined"!=typeof this.scoring[a-1]&&"undefined"!=typeof this.scoring[a-1][b]?this.scoring[a-1][b]+"":"-1"},this.setScore=function(a,b,c){return"undefined"==typeof this.scoring[a-1]&&(this.scoring[a-1]=Array()),"undefined"==typeof this.scoring[a-1][b]&&(this.scoring[a-1][b]="-1"),this.scoring[a-1][b]=c,this.scoring[a-1][b]},this.getExtraPoints=function(a,b){return"undefined"!=typeof this.extraPoints[a-1]&&"undefined"!=typeof this.extraPoints[a-1][b]&&this.extraPoints[a-1][b]>0?this.extraPoints[a-1][b]:0},this.getSteamArmyPoints=function(a,b){return"undefined"!=typeof this.steamArmyPoints[a-1]&&"undefined"!=typeof this.steamArmyPoints[a-1][b]&&this.steamArmyPoints[a-1][b]>0?this.steamArmyPoints[a-1][b]:0},this.getSteamControlPoints=function(a,b){return"undefined"!=typeof this.steamControlPoints[a-1]&&"undefined"!=typeof this.steamControlPoints[a-1][b]&&this.steamControlPoints[a-1][b]>0?this.steamControlPoints[a-1][b]:0},this.getPaintingPoints=function(a){return this.pointsPainting[a]?this.pointsPainting[a]:0},this.setPaintingPoints=function(a,b){return this.pointsPainting[a]=b,this.pointsPainting[a]},this.getCompPoints=function(a){return this.pointsComposition[a]?this.pointsComposition[a]:0},this.setCompPoints=function(a,b){return this.pointsComposition[a]=b,this.pointsComposition[a]},this.getSportsPoints=function(a){return this.pointsSportsmanship[a]?this.pointsSportsmanship[a]:0},this.setSportsPoints=function(a,b){return this.pointsSportsmanship[a]=b,this.pointsSportsmanship[a]},this.setExtraPoints=function(a,b,c){return"undefined"==typeof this.extraPoints[a-1]&&(this.extraPoints[a-1]=Array()),"undefined"==typeof this.extraPoints[a-1][b]&&(this.extraPoints[a-1][b]=-1),this.extraPoints[a-1][b]=c,this.extraPoints[a-1][b]},this.setSteamArmyPoints=function(a,b,c){return"undefined"==typeof this.steamArmyPoints[a-1]&&(this.steamArmyPoints[a-1]=Array()),"undefined"==typeof this.steamArmyPoints[a-1][b]&&(this.steamArmyPoints[a-1][b]=-1),this.steamArmyPoints[a-1][b]=c,this.steamArmyPoints[a-1][b]},this.setSteamControlPoints=function(a,b,c){return"undefined"==typeof this.steamControlPoints[a-1]&&(this.steamControlPoints[a-1]=Array()),"undefined"==typeof this.steamControlPoints[a-1][b]&&(this.steamControlPoints[a-1][b]=-1),this.steamControlPoints[a-1][b]=c,this.steamControlPoints[a-1][b]},this.sortPlayerObjsByScores=function(){this.calculateResults(),"swiss"==this.type?this.playerObjs.sort(sortByBaseScore):"steamroller"==this.type&&this.playerObjs.sort(steamPlayerSort);for(var a=1,b=0;b<this.playerObjs.length;b++)this.playerObjs[b].rank=a,a++},this.hasPlayedEachOther=function(a,b){if(a==b)return!0;if(-1==a||-1==b)return!1;if(0==this.currentRound)return!1;if(0==this.noDuplicateMatchups)return!1;for(var c=0;c<=this.currentRound;c++)if(this.matches[c])for(var d=0;d<this.matches.length;d++)if(this.matches[c][d].player1&&this.matches[c][d].player1&&this.matches[c][d].player1==a&&this.matches[c][d].player2==b||this.matches[c][d].player1==b&&this.matches[c][d].player2==a)return!0;return!1},this.hasHadBye=function(a){if(0==this.currentRound)return!1;for(var b=0;b<=this.currentRound;b++)if(this.matches[b])for(var c=0;c<this.matches.length;c++)if(this.matches[b][c].player1==a&&-1==this.matches[b][c].player2||-1==this.matches[b][c].player1&&this.matches[b][c].player2==a)return!0;return!1},this.createPlayerObjs=function(a){this.playerObjs=Array();for(var b=0;b<this.players.length;b++){var c=getPlayerByID(a,this.players[b]);c&&(""!=c.name.nick?c.displayName=c.name.first+' "'+c.name.nick+'" '+c.name.last:c.displayName=c.name.first+" "+c.name.last,this.playerObjs.push(c))}for(var d=0;d<this.numberOfRounds;d++){"undefined"==typeof this.scoring[d]&&(this.scoring[d]=Array());for(var b=0;b<this.playerObjs.length;b++)("undefined"==typeof this.scoring[d][this.playerObjs[b].id]||"-1"==this.scoring[d][this.playerObjs[b].id]||null==this.scoring[d][this.playerObjs[b].id])&&(this.isByeRound(d+1,this.playerObjs[b].id)?this.scoring[d][this.playerObjs[b].id]="bye":this.scoring[d][this.playerObjs[b].id]="-1"),"undefined"==typeof this.pointsPainting[this.playerObjs[b].id]&&(this.pointsPainting[this.playerObjs[b].id]=-1),"undefined"==typeof this.pointsComposition[this.playerObjs[b].id]&&(this.pointsComposition[this.playerObjs[b].id]=-1),"undefined"==typeof this.pointsSportsmanship[this.playerObjs[b].id]&&(this.pointsSportsmanship[this.playerObjs[b].id]=-1)}this.sortPlayerObjsByScores(),"steamroller"==this.type&&(this.playerObjs.length>64?this.numberOfRounds=7:this.playerObjs.length>32?this.numberOfRounds=6:this.playerObjs.length>16?this.numberOfRounds=5:this.playerObjs.length>8?this.numberOfRounds=4:this.numberOfRounds=3,this.pointsForWin=1,this.pointsForDraw=0,this.pointsForLoss=0,this.pointsForBye=1,this.byeIsAverage=!1,this.scoringPaint=!1,this.scoringComp=!1,this.scoringSportsmanship=!1)},this.isByeRound=function(a,b){if(this.matches[a])for(var c=0;c<this.matches[a].length;c++)if(this.matches[a][c].player1==b&&-1==this.matches[a][c].player2)return!0;return!1},this.getMatch=function(a,b){if(this.matches[a])for(var c=0;c<this.matches[a].length;c++)if(this.matches[a][c].player1==b&&-1!=this.matches[a][c].player2||this.matches[a][c].player2==b)return this.matches[a][c];return null},this.swapPlayers=function(a,b,c,d){for(var e=0;e<this.matches[c].length;e++)this.matches[c][e].player1==a?this.matches[c][e].player1=b:this.matches[c][e].player1==b&&(this.matches[c][e].player1=a),this.matches[c][e].player2==a?this.matches[c][e].player2=b:this.matches[c][e].player2==b&&(this.matches[c][e].player2=a);this.createMatchupObjs(d)},this.calculateResults=function(){this.totals=Array();for(var a=0;a<this.playerObjs.length;a++){numByes=0,playerTotal=0,this.playerObjs[a].steamControlPoints=0,this.playerObjs[a].steamArmyPoints=0;for(var b=0;b<this.scoring.length;b++)"bye"!=this.scoring[b][this.playerObjs[a].id]&&"-1"!=this.scoring[b][this.playerObjs[a].id]&&("win"==this.scoring[b][this.playerObjs[a].id]?playerTotal+=this.pointsForWin:"loss"==this.scoring[b][this.playerObjs[a].id]?playerTotal+=this.pointsForLoss:"draw"==this.scoring[b][this.playerObjs[a].id]&&(playerTotal+=this.pointsForDraw)),this.extraPoints[b]&&this.extraPoints[b][this.playerObjs[a].id]&&this.extraPoints[b][this.playerObjs[a].id]>0&&(playerTotal+=this.extraPoints[b][this.playerObjs[a].id]),this.steamControlPoints[b]&&this.steamControlPoints[b][this.playerObjs[a].id]&&this.steamControlPoints[b][this.playerObjs[a].id]>0&&(this.playerObjs[a].steamControlPoints+=this.steamControlPoints[b][this.playerObjs[a].id]),this.steamArmyPoints[b]&&this.steamArmyPoints[b][this.playerObjs[a].id]&&this.steamArmyPoints[b][this.playerObjs[a].id]>0&&(this.playerObjs[a].steamArmyPoints+=this.steamArmyPoints[b][this.playerObjs[a].id]),"bye"==this.scoring[b][this.playerObjs[a].id]&&((0==this.byeIsAverage||this.currentRound<2)&&(playerTotal+=this.pointsForBye),numByes++);1==this.byeIsAverage&&numByes>0&&this.currentRound>1&&(this.currentRound-numByes>0?(averageRound=Math.round(playerTotal/(this.currentRound-numByes)),playerTotal+=averageRound*numByes):playerTotal+=this.pointsForBye*numByes),this.totals[this.playerObjs[a].id]=playerTotal,this.playerObjs[a].pointsBase=playerTotal,this.playerObjs[a].pointsFinal=this.playerObjs[a].pointsBase,this.pointsPainting[this.playerObjs[a].id]>0&&(this.playerObjs[a].pointsFinal+=this.pointsPainting[this.playerObjs[a].id]),this.pointsComposition[this.playerObjs[a].id]>0&&(this.playerObjs[a].pointsFinal+=this.pointsComposition[this.playerObjs[a].id]),this.pointsSportsmanship[this.playerObjs[a].id]>0&&(this.playerObjs[a].pointsFinal+=this.pointsSportsmanship[this.playerObjs[a].id])}},"undefined"!=typeof a&&(this.players=a.players,this.name=a.name,"undefined"!=typeof a.currentRound&&(this.currentRound=a.currentRound),"undefined"!=typeof a.matches&&(this.matches=a.matches),"undefined"!=typeof a.created&&(this.created=new Date(a.created)),"undefined"!=typeof a.updated&&(this.updated=new Date(a.updated)),"undefined"!=typeof a.completed&&(this.completed=a.completed),"undefined"!=typeof a.scoring&&(this.scoring=a.scoring),"undefined"!=typeof a.extraPoints&&(this.extraPoints=a.extraPoints),"undefined"!=typeof a.pointsPainting&&(this.pointsPainting=a.pointsPainting),"undefined"!=typeof a.pointsComposition&&(this.pointsComposition=a.pointsComposition),"undefined"!=typeof a.pointsSportsmanship&&(this.pointsSportsmanship=a.pointsSportsmanship),"undefined"!=typeof a.numberOfRounds&&(this.numberOfRounds=a.numberOfRounds),"undefined"!=typeof a.pointsForWin&&(this.pointsForWin=a.pointsForWin),"undefined"!=typeof a.pointsForDraw&&(this.pointsForDraw=a.pointsForDraw),"undefined"!=typeof a.pointsForLoss&&(this.pointsForLoss=a.pointsForLoss),"undefined"!=typeof a.pointsForBye&&(this.pointsForBye=a.pointsForBye),"undefined"!=typeof a.byeIsAverage&&(this.byeIsAverage=a.byeIsAverage),"undefined"!=typeof a.scoringPaint&&(this.scoringPaint=a.scoringPaint),"undefined"!=typeof a.scoringComp&&(this.scoringComp=a.scoringComp),"undefined"!=typeof a.scoringSportsmanship&&(this.scoringSportsmanship=a.scoringSportsmanship),"undefined"!=typeof a.trackPerGameSportsmanship&&(this.trackPerGameSportsmanship=a.trackPerGameSportsmanship),"undefined"!=typeof a.warnSportsmanship&&(this.warnSportsmanship=a.warnSportsmanship),"undefined"!=typeof a.noDuplicateMatchups&&(this.noDuplicateMatchups=a.noDuplicateMatchups),"undefined"!=typeof a.matchupType&&(this.matchupType=a.matchupType),"undefined"!=typeof a.type&&(this.type=a.type),"undefined"!=typeof a.steamArmyPoints&&(this.steamArmyPoints=a.steamArmyPoints),"undefined"!=typeof a.steamControlPoints&&(this.steamControlPoints=a.steamControlPoints)),"undefined"!=typeof b&&this.createPlayerObjs(b)}var globalRoutes=["$routeProvider","$translateProvider",function(a,b,c,d){for(lang_count=0;lang_count<available_languages.length;lang_count++)available_languages[lang_count].active&&b.translations(available_languages[lang_count].short_code,available_languages[lang_count].translations);b.useSanitizeValueStrategy("sanitize"),preferred_language="en-US",localStorage&&localStorage["tmp.preferred_language"]?preferred_language=localStorage["tmp.preferred_language"]:localStorage["tmp.preferred_language"]="en-US",b.preferredLanguage(preferred_language),a.when("/",{templateUrl:"pages/welcome.html",controller:"welcomeController"}).when("/credits",{templateUrl:"pages/credits.html",controller:"creditsController"}).when("/settings",{templateUrl:"pages/settings.html",controller:"settingsController"}).when("/players-manage",{templateUrl:"pages/players-manage.html",controller:"controllerPlayersManage"}).when("/players-deleted",{templateUrl:"pages/players-deleted.html",controller:"controllerPlayersManage"}).when("/tournaments-manage",{templateUrl:"pages/tournaments-manage.html",controller:"controllerTourmamentsManage"}).when("/tournaments-run",{templateUrl:"pages/tournaments-run.html",controller:"controllerTourmamentsRun"})}],available_languages=[],appVersion="0.01Alpha";cordovaApp=angular.module("cordovaApp",["ngRoute","ngResource","ngSanitize","pascalprecht.translate","as.sortable","mm.foundation"],globalRoutes),angular.module("cordovaApp").controller("select_language",["$translate","$scope","$route",function(a,b,c){b.change_language=function(b){a.use(b),localStorage["tmp.preferred_language"]=b,c.reload()}}]),cordovaApp.config(["$compileProvider",function(a){a.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|tel|file|blob):/)}]);var available_languages=[],appVersion="0.01Alpha";webApp=angular.module("webApp",["ngRoute","ngResource","ngSanitize","pascalprecht.translate","as.sortable","mm.foundation"],globalRoutes),angular.module("webApp").controller("select_language",["$translate","$scope","$route",function(a,b,c){b.change_language=function(b){a.use(b),localStorage["tmp.preferred_language"]=b,c.reload()}}]),webApp.config(["$compileProvider",function(a){a.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|tel|file|blob):/)}]);var class_dice=function(){};class_dice.prototype={init:function(){this.always_exploding_dice=!1,this.roll_set_count_rolls=[],this.roll_set_count=0,this.label_no_effect="No Effect",this.label_shaken="Shaken",this.label_shaken_and_a_wound="Shaken and a wound",this.label_shaken_and_x_wounds="Shaken and {raises} wounds",this.label_critical_failure="Critical Failure",this.label_failure="Failure",this.label_success="Success",this.label_success_with_a_raise="Success with a raise",this.label_success_with_x_raises="Success with {raises} raises",this.label_die_roll_number="die roll #",this.label_wild_die_roll_number="wild die roll #",this.label_roll_set_number="Roll Set #",this.label_total_roll="Total Roll",this.success_target_number=4,this.success_base_toughness=5,this.success_armor=1,this.success_weapons_ap=0},roll_die:function(a,b,c){for(a||(a=6),total_roll=0,keep_rolling=1,display_roll="";keep_rolling>0;)roll=Math.floor(Math.random()*a)+1,b>0&&roll==a?keep_rolling=1:keep_rolling=0,display_roll+=roll+", ",total_roll+=roll;if(this.roll_set_count_rolls[this.roll_set_count].base_rolls.push(display_roll),this.roll_set_count_rolls[this.roll_set_count].base_roll_sides.push(a),wild_display_roll="",totalwild_dieRoll=0,keep_rolling=1,c>0)for(a=6;keep_rolling>0;)roll=Math.floor(Math.random()*a)+1,b>0&&roll==a?keep_rolling=1:keep_rolling=0,totalwild_dieRoll+=roll,wild_display_roll+=roll+", ";return this.roll_set_count_rolls[this.roll_set_count].wild_die_rolls.push(wild_display_roll),1==totalwild_dieRoll&&1==total_roll?this.roll_set_count_rolls[this.roll_set_count].critical_failure=1:this.roll_set_count_rolls[this.roll_set_count].critical_failure=0,totalwild_dieRoll>total_roll?totalwild_dieRoll:total_roll},roll_dice:function(a,b){var c=0;number_of_sides=6,a.indexOf("*")>0?wild_die=1:wild_die=0,number_of_sides<2&&(number_of_sides=2),a=a.replace("*",""),explodingDice=0,a.indexOf("d")>-1?(rollNumber=a.substring(0,a.indexOf("d"))/1,number_of_sides=a.substring(a.indexOf("d")+1)/1,this.always_exploding_dice&&(explodingDice=1)):a.indexOf("e")>-1?(explodingDice=1,rollNumber=a.substring(0,a.indexOf("e"))/1,number_of_sides=a.substring(a.indexOf("e")+1)/1):rollNumber=a,rollNumber||(rollNumber=1),number_of_sides||(number_of_sides=6);for(var d=rollNumber+"d"+number_of_sides+": ";rollNumber-- >0;)dieRoll=this.roll_die(number_of_sides,explodingDice,wild_die),c+=dieRoll,d+=dieRoll+",",this.roll_set_count_rolls[this.roll_set_count].total_rolled_dice++;return d=d.substring(0,d.length-1),d+="",c},_parse_bit:function(a){return value=0,a.indexOf("d")>-1?value=this.roll_dice(a,0):a.indexOf("e")>-1?value=this.roll_dice(a,0):value=a/1,value},_parse_roll_set:function(a){if(set_total=0,a=a.replace(/ /g,""),a=a.toLowerCase(),a=a.replace(/\+/g," + "),a=a.replace(/x/g," x "),a=a.replace(/\//g," / "),a=a.replace(/\-/g," - "),a=a.replace(/\)/g," ) "),a=a.replace(/\(/g," ( "),a=a.replace(/\,/g," , "),this.roll_set_count_rolls[this.roll_set_count]={},this.roll_set_count_rolls[this.roll_set_count].base_rolls=[],this.roll_set_count_rolls[this.roll_set_count].wild_die_rolls=[],this.roll_set_count_rolls[this.roll_set_count].base_roll_sides=[],this.roll_set_count_rolls[this.roll_set_count].total_rolled_dice=0,this.roll_set_count_rolls[this.roll_set_count].critical_failure=0,a.indexOf(" ")>0)for(items=a.split(" "),current_function="+",count=0;count<items.length;count++)"+"!=items[count]&&"x"!=items[count]&&"-"!=items[count]&&"/"!=items[count]?"+"==current_function?set_total+=this._parse_bit(items[count])/1:"-"==current_function?set_total-=this._parse_bit(items[count])/1:"x"==current_function?0==set_total?set_total=items[count]/1:set_total=set_total*this._parse_bit(items[count])/1:"/"==current_function&&(set_total=set_total/this._parse_bit(items[count])/1):current_function=items[count];else set_total+=this._parse_bit(a);this.roll_set_count_rolls[this.roll_set_count].total_roll=set_total,this.roll_set_count++},parse_roll:function(a){if(total=0,this.roll_set_count=0,this.roll_set_count_rolls=[],a.indexOf(",")>0)for(parse_roll_items=a.split(","),parse_roll_itemcount=0;parse_roll_itemcount<parse_roll_items.length;parse_roll_itemcount++)total=this._parse_roll_set(parse_roll_items[parse_roll_itemcount]);else total+=this._parse_roll_set(a);return total},display_results:function(a,b){for(html="",results_set_count=0;results_set_count<this.roll_set_count;results_set_count++)for(this.roll_set_count>1&&(results_set_count>0&&(html+="<hr />"),html+="<h4>"+this.label_roll_set_number+(results_set_count+1)+"</h4>"),html+="<h5>"+this.label_total_roll+": "+this.roll_set_count_rolls[results_set_count].total_roll+"</h5>",a&&(html+=this.trait_success_margin(this.roll_set_count_rolls[results_set_count].total_roll,null,results_set_count)+"<br />"),b&&(html+=this.damage_success_margin(this.roll_set_count_rolls[results_set_count].total_roll)+"<br />"),current_roll=0;current_roll<this.roll_set_count_rolls[results_set_count].total_rolled_dice;current_roll++)"undefined"!=typeof this.roll_set_count_rolls[results_set_count].base_rolls[current_roll]&&(html+="<br />"+this.label_die_roll_number+(current_roll+1)+" (d"+this.roll_set_count_rolls[results_set_count].base_roll_sides[current_roll]+"): ",this.roll_set_count_rolls[results_set_count].base_rolls[current_roll]&&(this.roll_set_count_rolls[results_set_count].base_rolls[current_roll].length>2?html+=this.roll_set_count_rolls[results_set_count].base_rolls[current_roll].substring(0,this.roll_set_count_rolls[results_set_count].base_rolls[current_roll].length-2):html+=this.roll_set_count_rolls[results_set_count].base_rolls[current_roll])),"undefined"!=typeof this.roll_set_count_rolls[results_set_count].wild_die_rolls[current_roll]&&(this.roll_set_count_rolls[results_set_count].wild_die_rolls[current_roll].length>0&&(html+="<br />"+this.label_wild_die_roll_number+(current_roll+1)+" (d6): "),this.roll_set_count_rolls[results_set_count].wild_die_rolls[current_roll]&&(this.roll_set_count_rolls[results_set_count].wild_die_rolls[current_roll].length>2?html+=this.roll_set_count_rolls[results_set_count].wild_die_rolls[current_roll].substring(0,this.roll_set_count_rolls[results_set_count].wild_die_rolls[current_roll].length-2):html+=this.roll_set_count_rolls[results_set_count].wild_die_rolls[current_roll]));return html},trait_success_margin:function(a,b,c){return b||(b=this.success_target_number),value=a/1-b/1,html="","undefined"!=typeof c&&this.roll_set_count_rolls[c].critical_failure>0?html+='<span  class="color-red bolded uppercase">'+this.label_critical_failure+"</span>":value<0?html+='<span  class="color-red">'+this.label_failure+"</span>":(raises=Math.floor(value/4),0==raises?html+=this.label_success:1==raises?html+='<span  class="color-green bolded">'+this.label_success_with_a_raise+"</span>":html+='<span  class="color-green bolded uppercase">'+this.label_success_with_x_raises.replace("{raises}",raises)+"</span>"),html},set_result_margins:function(a,b,c,d){this.success_target_number=a,this.success_base_toughness=b,this.success_armor=c,this.success_weapons_ap=d},set_label:function(a,b){return"no_effect"==a?(this.label_no_effect=b,b):"total_roll"==a?(this.label_total_roll=b,b):"shaken"==a?(this.label_shaken=b,b):"shaken_and_a_wound"==a?(this.label_shaken_and_a_wound=b,b):"shaken_and_x_wounds"==a?(this.label_shaken_and_x_wounds=b,b):"critical_failure"==a?(this.label_critical_failure=b,b):"roll_set_number"==a?(this.label_roll_set_number=b,b):"failure"==a?(this.label_failure=b,b):"success"==a?(this.label_success=b,b):"success_with_a_raise"==a?(this.label_success_with_a_raise=b,b):"success_with_x_raises"==a?(this.label_success_with_x_raises=b,b):"die_roll_number"==a?(this.label_die_roll_number=b,b):"wild_die_roll_number"==a?(this.label_wild_die_roll_number=b,b):null},set_always_exploding_dice:function(a){return this.always_exploding_dice=a,this.always_exploding_dice},damage_success_margin:function(a,b,c,d){return b||(b=this.success_base_toughness),c||(c=this.success_armor),d||(d=this.success_weapons_ap),c=c/1-d/1,0>c&&(c=0),target_number=b/1+c/1,value=a/1-target_number/1,html="",value<0?html+="<span>"+this.label_no_effect+"</span>":(raises=Math.floor(value/4),0==raises?html+='<span class="color-orange">'+this.label_shaken+"</span>":1==raises?html+='<span class="color-red">'+this.label_shaken_and_a_wound+"</span>":html+='<span class="color-red bolded uppercase">'+this.label_shaken_and_x_wounds.replace("{raises}",raises)+"</span>"),html}};var creditsArray=["$rootScope","$translate","$scope",function(a,b,c){b(["APP_TITLE","INDEX_WELCOME"]).then(function(b){a.title_tag=b.INDEX_WELCOME+" | "+b.APP_TITLE,a.subtitle_tag="&raquo; "+b.INDEX_CREDITS}),c.currentCreditsPage=!0,a.playerList=getPlayersFromLocalStorage(),a.tournamentList=getTournamentsFromLocalStorage();for(var d=0;d<a.tournamentList.length;d++)a.tournamentList[d].createPlayerObjs(a.playerList);c.currentTournament=null,a.tournamentList[localStorage.current_tournament_view]&&(c.currentTournament=a.tournamentList[localStorage.current_tournament_view])}];angular.module("webApp").controller("creditsController",creditsArray),angular.module("cordovaApp").controller("creditsController",creditsArray);var coreGlobalFunctions=function(a,b,c,d,e,f){b.updatePlayerFirstName=function(a){b.tmpPlayer.name.first=a},b.updatePlayerLastName=function(a){b.tmpPlayer.name.last=a},b.updatePlayerNickName=function(a){b.tmpPlayer.name.nick=a},b.updatePlayerActive=function(a){b.tmpPlayer.active=a},b.updatePlayerEmail=function(a){b.tmpPlayer.email=a},b.updatePlayerPhone1=function(a){b.tmpPlayer.phone1=a},b.newPlayerDialog=function(){b.clearTempPlayerData(),b.showEditPlayerDialog=!0},b.deletePlayerDialog=function(a){c(["PLAYERS_DELETE_CONFIRMATION"]).then(function(c){b.confirmDialog(c.PLAYERS_DELETE_CONFIRMATION,function(){b.showConfirmDialog=!1;for(var c=0;c<b.playerList.length;c++)a==b.playerList[c].id&&(b.playerList[c].deleted=!0,savePlayersToLocalStorage(b.playerList),b.getNumberOfDeleted())})})},b.restorePlayerFromDelete=function(a){indexNumber=getPlayerIndexByID(b.playerList,a),b.playerList[indexNumber]?(b.playerList[indexNumber].deleted=!1,savePlayersToLocalStorage(b.playerList),b.getNumberOfDeleted()):console.log("ERROR","No playerID "+a+" found!")},b.editPlayerDialog=function(a){indexNumber=getPlayerIndexByID(b.playerList,a),b.playerList[indexNumber]&&(b.tmpPlayer=angular.copy(b.playerList[indexNumber]),b.tmpPlayerIndex=indexNumber,b.showEditPlayerDialog=!0)},b.clearTempPlayerData=function(){b.tmpPlayer=new Player,b.tmpPlayerIndex=-1},b.saveEditPlayerDialog=function(){b.showEditPlayerDialog=!1,b.tmpPlayerIndex>-1?(b.tmpPlayer.updated=new Date,b.tmpPlayer.id<0&&(newID=getNextPlayerID(b.playerList),b.tmpPlayer.id=newID),b.playerList[b.tmpPlayerIndex]=new Player(b.tmpPlayer)):(newID=getNextPlayerID(b.playerList),b.tmpPlayer.created=new Date,b.tmpPlayer.updated=new Date,b.tmpPlayer.id=newID,b.playerList.push(new Player(b.tmpPlayer))),savePlayersToLocalStorage(b.playerList),b.getNumberOfDeleted(),b.clearTempPlayerData()},b.getNumberOfDeleted=function(){b.deletedPlayers=Array(),b.activePlayers=Array();for(var a=0;a<b.playerList.length;a++)b.playerList[a].deleted?b.deletedPlayers.push(b.playerList[a]):b.activePlayers.push(b.playerList[a]);b.numDeletedPlayers=b.deletedPlayers.length},b.closeEditPlayerDialog=function(){b.showEditPlayerDialog=!1,b.clearTempPlayerData()}};angular.module("webApp").run(["$timeout","$rootScope","$translate","$location","$route",coreGlobalFunctions]),angular.module("cordovaApp").run(["$timeout","$rootScope","$translate","$location","$route","$cordovaFile",coreGlobalFunctions]);var playersManageArray=["$rootScope","$translate","$scope","$http",function(a,b,c,d){b(["APP_TITLE","WELCOME_BUTTON_MANAGE_PLAYERS"]).then(function(b){a.title_tag=b.WELCOME_BUTTON_MANAGE_PLAYERS+" | "+b.APP_TITLE,a.subtitle_tag="&raquo; "+b.WELCOME_BUTTON_MANAGE_PLAYERS}),c.currentPlayersPage=!0,a.playerList=getPlayersFromLocalStorage(),a.tournamentList=getTournamentsFromLocalStorage();for(var e=0;e<a.tournamentList.length;e++)a.tournamentList[e].createPlayerObjs(a.playerList);c.currentTournament=null,a.tournamentList[localStorage.current_tournament_view]&&(c.currentTournament=a.tournamentList[localStorage.current_tournament_view]),a.getNumberOfDeleted(),c.confirmDialogQuestion="",c.showImportExportPlayerDialog=!1,c.confirmDialog=function(a,b){c.confirmDialogQuestion=a,c.showConfirmDialog=!0,c.confirmDialogYes=b},c.closeConfirmDialog=function(){c.showConfirmDialog=!1,c.confirmDialogYes=function(){c.showConfirmDialog=!1}},c.importExportPlayersDialog=function(){var a=JSON.stringify(c.playerList),b=new Blob([a],{type:"application/javascript"});c.downloadPlayerData=(window.URL||window.webkitURL).createObjectURL(b),c.showImportExportPlayerDialog=!0},c.closeImportExportPlayerDialog=function(){c.showImportExportPlayerDialog=!1},c.uploadFile=function(b){for(var d=new FileReader,e=0;e<b.length;e++){var f=b[e];d.onload=function(b){if(b.target&&b.target.result){var d=JSON.parse(b.target.result);if(playersUpdated=0,playersCreated=0,d){objectified=Array();for(var e=0;e<d.length;e++){var f=new Player(d[e]);playerIDExists=getPlayerIndexByID(a.playerList,f.id),playerIDExists>-1?c.importAsNewPlayers?(f.id=getNextPlayerID(a.playerList),objectified.push(f),playersCreated++):(a.playerList[playerIDExists]=f,playersUpdated++):(objectified.push(f),playersCreated++)}a.playerList=a.playerList.concat(objectified),savePlayersToLocalStorage(a.playerList),a.getNumberOfDeleted()}}},d.readAsText(f)}}}];angular.module("webApp").controller("controllerPlayersManage",playersManageArray),
angular.module("cordovaApp").controller("controllerPlayersManage",playersManageArray);var tournamentsManageArray=["$rootScope","$translate","$location","$scope",function(a,b,c,d){b(["APP_TITLE","WELCOME_BUTTON_MANAGE_TOURNAMENTS","TOURNAMENTS_MATCHUP_HIGHEST_RANKING","TOURNAMENTS_MATCHUP_RANDOM"]).then(function(b){a.title_tag=b.WELCOME_BUTTON_MANAGE_TOURNAMENTS+" | "+b.APP_TITLE,a.subtitle_tag="&raquo; "+b.WELCOME_BUTTON_MANAGE_TOURNAMENTS,d.tournamentMatchupOptions=Array(),d.tournamentMatchupOptions.push({id:"highest-ranking",label:b.TOURNAMENTS_MATCHUP_HIGHEST_RANKING}),d.tournamentMatchupOptions.push({id:"random",label:b.TOURNAMENTS_MATCHUP_RANDOM}),d.tmpMatchupSelection=d.tournamentMatchupOptions[0]}),d.currentTournamentsPage=!0,d.refreshTournamentData=function(){a.playerList=getPlayersFromLocalStorage(),a.tournamentList=getTournamentsFromLocalStorage();for(var b=0;b<a.tournamentList.length;b++)a.tournamentList[b].createPlayerObjs(a.playerList)},d.refreshTournamentData(),d.currentTournament=null,a.tournamentList[localStorage.current_tournament_view]&&(d.currentTournament=a.tournamentList[localStorage.current_tournament_view],(0==d.currentTournament.playerObjs.length||d.currentTournament.completed)&&(d.currentTournament=null)),d.confirmDialogQuestion="",d.showImportExportTournamentDialog=!1,d.confirmDialog=function(a,b){d.confirmDialogQuestion=a,d.showConfirmDialog=!0,d.confirmDialogYes=b},d.closeConfirmDialog=function(){d.showConfirmDialog=!1,d.confirmDialogYes=function(){d.showConfirmDialog=!1}},d.updateTournamentName=function(a){d.tmpTournament.name=a},d.updateTournamentRounds=function(a){d.tmpTournament.numberOfRounds=a},d.updateTournamentPointsForWin=function(a){d.tmpTournament.pointsForWin=a},d.updateTournamentPointsForDraw=function(a){d.tmpTournament.pointsForDraw=a},d.updateTournamentPointsForLoss=function(a){d.tmpTournament.pointsForLoss=a},d.updateByeIsAverage=function(a){d.tmpTournament.byeIsAverage=a},d.updateTournamentPointsForBye=function(a){d.tmpTournament.pointsForBye=a},d.updateTournamentScoringPaint=function(a){d.tmpTournament.scoringPaint=a},d.updateTournamentScoringComp=function(a){d.tmpTournament.scoringComp=a},d.updateTournamentScoringSportsmanship=function(a){d.tmpTournament.scoringSportsmanship=a},d.updateTournamentTrackPerGameSportsmanship=function(a){d.tmpTournament.trackPerGameSportsmanship=a},d.updateTournamentWarnSportsmanship=function(a){d.tmpTournament.warnSportsmanship=a},d.newTournamentDialog=function(){d.clearTempTournamentData(),d.getMatchupSelection(d.tmpTournament.matchupType),d.showEditTournamentDialog=!0},d.updateTmpMatchupSelection=function(a){d.tmpMatchupSelection=a},d.updateNoDuplicateMatchups=function(a){d.tmpTournament.noDuplicateMatchups=a},d.deleteTournamentDialog=function(c){b(["TOURNAMENTS_DELETE_CONFIRMATION"]).then(function(b){d.confirmDialog(b.TOURNAMENTS_DELETE_CONFIRMATION,function(){d.showConfirmDialog=!1,a.tournamentList.splice(c,1),saveTournamentsToLocalStorage(a.tournamentList,a.playerList)})})},d.editTournamentDialog=function(b){a.tournamentList[b]&&(d.tmpTournament=angular.copy(a.tournamentList[b]),d.getMatchupSelection(d.tmpTournament.matchupType),d.tmpTournamentIndex=b,d.showEditTournamentDialog=!0)},d.clearTempTournamentData=function(){d.tmpTournament=new Tournament,d.getMatchupSelection(d.tmpTournament.matchupType),d.tmpTournamentIndex=-1},d.getMatchupSelection=function(a){d.tmpMatchupSelection=d.tournamentMatchupOptions[0];for(var b=0;b<d.tournamentMatchupOptions.length;b++)d.tournamentMatchupOptions[b].id==a&&(d.tmpMatchupSelection=d.tournamentMatchupOptions[b])},d.saveEditTournamentDialog=function(){d.showEditTournamentDialog=!1,d.tmpTournament.matchupType=d.tmpMatchupSelection.id,d.tmpTournamentIndex>-1?(d.tmpTournament.updated=new Date,a.tournamentList[d.tmpTournamentIndex]=d.tmpTournament,saveTournamentsToLocalStorage(a.tournamentList,a.playerList),d.clearTempTournamentData()):(newID=getNextPlayerID(a.playerList),d.tmpTournament.created=new Date,d.tmpTournament.updated=new Date,a.tournamentList.id=newID,a.tournamentList.push(d.tmpTournament),saveTournamentsToLocalStorage(a.tournamentList,a.playerList),d.clearTempTournamentData(),d.editTournamentPlayersDialog(a.tournamentList.length-1))},d.closeEditTournamentDialog=function(){d.showEditTournamentDialog=!1,d.clearTempTournamentData()},d.showTournamentResults=function(a){alert("showTournamentResults("+a+") called - TODO")},d.showTournamentPage=function(a){localStorage.current_tournament_view=a,c.path("tournaments-run")},d.addPlayerToTournament=function(b){d.tmpTournament.players.push(b),d.tmpTournament.createPlayerObjs(d.playerList),saveTournamentsToLocalStorage(a.tournamentList,a.playerList),d.updateAvailableParticipatingPlayers()},d.removePlayerFromTournament=function(b){for(var c=0;c<d.tmpTournament.players.length;c++)d.tmpTournament.players[c]==b&&(d.tmpTournament.players.splice(c,1),saveTournamentsToLocalStorage(a.tournamentList,a.playerList),d.updateAvailableParticipatingPlayers())},d.updateAvailableParticipatingPlayers=function(){d.availablePlayers=Array(),d.participatingPlayers=angular.copy(d.tmpTournament.playerObjs);for(var a=0;a<d.playerList.length;a++)-1===d.tmpTournament.players.indexOf(d.playerList[a].id)&&1==d.playerList[a].active&&0==d.playerList[a].deleted&&d.availablePlayers.push(d.playerList[a]);d.availablePlayers.sort(sortByNames),d.participatingPlayers.sort(sortByNames)},d.showEditTournamentPlayersDialog=!1,d.editTournamentPlayersDialog=function(b){d.tmpTournament=a.tournamentList[b],d.updateAvailableParticipatingPlayers(),d.showEditTournamentPlayersDialog=!0},d.closeTournamentPlayersDialog=function(){d.showEditTournamentPlayersDialog=!1,d.tmpTournament=null},d.importExportTournamentsDialog=function(){for(var a=d.tournamentList,b=0;b<a.length;b++)delete a[b].playerObjs;var c=JSON.stringify(a),e=new Blob([c],{type:"application/javascript"});d.downloadTournamentData=(window.URL||window.webkitURL).createObjectURL(e),d.showImportExportTournamentDialog=!0},d.closeImportExportTournamentDialog=function(){d.showImportExportTournamentDialog=!1},d.uploadFile=function(b){for(var c=new FileReader,d=0;d<b.length;d++){var e=b[d];c.onload=function(b){if(b.target&&b.target.result){var c=JSON.parse(b.target.result);if(c){objectified=Array();for(var d=0;d<c.length;d++){var e=new Tournament(c[d]);objectified.push(e)}a.tournamentList=a.tournamentList.concat(objectified),saveTournamentsToLocalStorage(a.tournamentList,a.playerList)}}},c.readAsText(e)}}}];angular.module("webApp").controller("controllerTourmamentsManage",tournamentsManageArray),angular.module("cordovaApp").controller("controllerTourmamentsManage",tournamentsManageArray);var tournamentsRunArray=["$rootScope","$translate","$location","$scope","$route",function(a,b,c,d,e){b(["APP_TITLE","WELCOME_BUTTON_MANAGE_TOURNAMENTS"]).then(function(b){a.title_tag=b.WELCOME_BUTTON_MANAGE_TOURNAMENTS+" | "+b.APP_TITLE,a.subtitle_tag="&raquo; "+b.WELCOME_BUTTON_MANAGE_TOURNAMENTS}),d.currentTournamentsRun=!0,a.playerList=getPlayersFromLocalStorage(),a.tournamentList=getTournamentsFromLocalStorage();for(var f=0;f<a.tournamentList.length;f++)a.tournamentList[f].createPlayerObjs(a.playerList);d.currentTournament=null,a.tournamentList[localStorage.current_tournament_view]&&(d.currentTournament=a.tournamentList[localStorage.current_tournament_view],d.currentTournament.calculateResults()),d.editScore=function(a,b){var c=d.currentTournament.getMatch(b,a);d.tmpPlayer1Score=-1,d.tmpPlayer1Score=-1,d.tmpPlayer1ExtraPoints=0,d.tmpPlayer2ExtraPoints=0,d.tmpPlayer1SteamArmyPoints=0,d.tmpPlayer1SteamControlPoints=0,d.tmpPlayer2SteamArmyPoints=0,d.tmpPlayer2SteamControlPoints=0,d.editScorePlayer1=getPlayerByID(d.playerList,c.player1),d.editScorePlayer2=getPlayerByID(d.playerList,c.player2),d.tmpPlayer1Score=d.currentTournament.getScore(b,c.player1),d.tmpPlayer2Score=d.currentTournament.getScore(b,c.player2),d.tmpPlayer1ExtraPoints=d.currentTournament.getExtraPoints(b,c.player1),d.tmpPlayer2ExtraPoints=d.currentTournament.getExtraPoints(b,c.player2),d.tmpPlayer1SteamArmyPoints=d.currentTournament.getSteamArmyPoints(b,c.player1),d.tmpPlayer1SteamControlPoints=d.currentTournament.getSteamControlPoints(b,c.player1),d.tmpPlayer2SteamArmyPoints=d.currentTournament.getSteamArmyPoints(b,c.player2),d.tmpPlayer2SteamControlPoints=d.currentTournament.getSteamControlPoints(b,c.player2),d.editRoundNumber=b,d.editTableNumber=c.table,d.showEditScoreDialog=!0},d.changePlayerScore=function(a,b){1==a?(d.tmpPlayer1Score=b,"win"==b?d.tmpPlayer2Score="loss":"draw"==b?d.tmpPlayer2Score="draw":"loss"==b?d.tmpPlayer2Score="win":d.tmpPlayer2Score="-1"):(d.tmpPlayer2Score=b,"win"==b?d.tmpPlayer1Score="loss":"draw"==b?d.tmpPlayer1Score="draw":"loss"==b?d.tmpPlayer1Score="win":d.tmpPlayer1Score="-1")},d.changePlayerExtraPoints=function(a,b){1==a?d.tmpPlayer1ExtraPoints=b:d.tmpPlayer2ExtraPoints=b},d.changeSteamControlPoints=function(a,b){1==a?d.tmpPlayer1SteamControlPoints=b:d.tmpPlayer2SteamControlPoints=b},d.changeSteamArmyPoints=function(a,b){1==a?d.tmpPlayer1SteamArmyPoints=b:d.tmpPlayer2SteamArmyPoints=b},d.cancelEditScoreDialog=function(){d.showEditScoreDialog=!1,d.editScorePlayer1=null,d.editScorePlayer2=null,d.tmpPlayer1Score=-1,d.tmpPlayer1Score=-1,d.tmpPlayer1ExtraPoints=0,d.tmpPlayer2ExtraPoints=0,d.tmpPlayer1SteamArmyPoints=0,d.tmpPlayer1SteamControlPoints=0,d.tmpPlayer2SteamArmyPoints=0,d.tmpPlayer2SteamControlPoints=0,d.editRoundNumber=-1,d.editTableNumber=-1,e.reload()},d.saveEditScoreDialog=function(){d.currentTournament.setScore(d.editRoundNumber,d.editScorePlayer1.id,d.tmpPlayer1Score),d.currentTournament.setScore(d.editRoundNumber,d.editScorePlayer2.id,d.tmpPlayer2Score),d.currentTournament.setExtraPoints(d.editRoundNumber,d.editScorePlayer1.id,d.tmpPlayer1ExtraPoints),d.currentTournament.setExtraPoints(d.editRoundNumber,d.editScorePlayer2.id,d.tmpPlayer2ExtraPoints),d.currentTournament.setSteamArmyPoints(d.editRoundNumber,d.editScorePlayer1.id,d.tmpPlayer1SteamArmyPoints),d.currentTournament.setSteamArmyPoints(d.editRoundNumber,d.editScorePlayer2.id,d.tmpPlayer2SteamArmyPoints),d.currentTournament.setSteamControlPoints(d.editRoundNumber,d.editScorePlayer1.id,d.tmpPlayer1SteamControlPoints),d.currentTournament.setSteamControlPoints(d.editRoundNumber,d.editScorePlayer2.id,d.tmpPlayer2SteamControlPoints),d.currentTournament.calculateResults(),saveTournamentsToLocalStorage(a.tournamentList,a.playerList),d.showEditScoreDialog=!1,d.editScorePlayer1=null,d.editScorePlayer2=null,d.tmpPlayer1Score=-1,d.tmpPlayer1Score=-1,d.tmpPlayer1ExtraPoints=0,d.tmpPlayer2ExtraPoints=0,d.tmpPlayer1SteamArmyPoints=0,d.tmpPlayer1SteamArmyPoints=0,d.tmpPlayer2SteamArmyPoints=0,d.tmpPlayer2SteamControlPoints=0,d.editRoundNumber=-1,d.editTableNumber=-1,e.reload()},d.editPaintingScore=function(a){d.tmpEditPlayer=Array(),d.tmpEditExtraPointValue=0,d.tmpEditPlayer=getPlayerByID(d.playerList,a),d.tmpEditExtraPointValue=d.currentTournament.getPaintingPoints(a),d.tmpEditExtraPointValue<0&&(d.tmpEditExtraPointValue=0),d.showEditPaintScore=!0},d.editCompositionScore=function(a){d.tmpEditPlayer=Array(),d.tmpEditExtraPointValue=0,d.tmpEditPlayer=getPlayerByID(d.playerList,a),d.tmpEditExtraPointValue=d.currentTournament.getCompPoints(a),d.tmpEditExtraPointValue<0&&(d.tmpEditExtraPointValue=0),d.showEditCompScore=!0},d.editSportsmanshipScore=function(a){d.tmpEditPlayer=Array(),d.tmpEditExtraPointValue=0,d.tmpEditPlayer=getPlayerByID(d.playerList,a),d.tmpEditExtraPointValue=d.currentTournament.getSportsPoints(a),d.tmpEditExtraPointValue<0&&(d.tmpEditExtraPointValue=0),d.showEditSportsScore=!0},d.saveSportsScore=function(){d.currentTournament.setSportsPoints(d.tmpEditPlayer.id,d.tmpEditExtraPointValue),saveTournamentsToLocalStorage(a.tournamentList,a.playerList),d.currentTournament.calculateResults(),d.cancelEditScore()},d.saveCompScore=function(){d.currentTournament.setCompPoints(d.tmpEditPlayer.id,d.tmpEditExtraPointValue),saveTournamentsToLocalStorage(a.tournamentList,a.playerList),d.currentTournament.calculateResults(),d.cancelEditScore()},d.savePaintScore=function(){d.currentTournament.setPaintingPoints(d.tmpEditPlayer.id,d.tmpEditExtraPointValue),saveTournamentsToLocalStorage(a.tournamentList,a.playerList),d.currentTournament.calculateResults(),d.cancelEditScore()},d.changeExtraBitsScore=function(a){d.tmpEditExtraPointValue=a},d.cancelEditScore=function(){d.tmpEditPlayer=null,d.tmpEditExtraPointValue=null,d.showEditPaintScore=!1,d.showEditCompScore=!1,d.showEditSportsScore=!1},d.closeCurrentTournament=function(){d.currentTournament=null,localStorage.current_tournament_view=-1,c.path("tournaments-manage")},d.setupNextRound=function(){d.currentTournament.createMatchRound(d.currentTournament.currentRound+1,d.playerList),d.playerMatchupDialog=!0},d.closePlayerMatchupDialog=function(){d.playerMatchupDialog=!1},d.resetMatchups=function(){d.currentTournament.createMatchRound(d.currentTournament.currentRound+1,d.playerList)},d.swapPlayerButton=function(a){d.tmpMatchupSwappingID>0?(d.currentTournament.swapPlayers(d.tmpMatchupSwappingID,a,d.currentTournament.currentRound+1,d.playerList),d.tmpMatchupSwappingID=0):d.tmpMatchupSwappingID=a},d.cancelSwap=function(){d.tmpMatchupSwappingID=0},d.completeTournament=function(){d.currentTournament.completed=!0,saveTournamentsToLocalStorage(a.tournamentList,a.playerList)},d.startNextRound=function(){d.currentTournament.currentRound++,saveTournamentsToLocalStorage(a.tournamentList,a.playerList),d.playerMatchupDialog=!1}}];angular.module("webApp").controller("controllerTourmamentsRun",tournamentsRunArray),angular.module("cordovaApp").controller("controllerTourmamentsRun",tournamentsRunArray);var settingsArray=["$rootScope","$translate","$scope","$route",function(a,b,c,d){b(["APP_TITLE","GENERAL_SETTINGS"]).then(function(b){a.title_tag=b.GENERAL_SETTINGS+" | "+b.APP_TITLE,a.subtitle_tag=b.GENERAL_SETTINGS}),c.currentSettingsPage=!0,a.playerList=getPlayersFromLocalStorage(),a.tournamentList=getTournamentsFromLocalStorage();for(var e=0;e<a.tournamentList.length;e++)a.tournamentList[e].createPlayerObjs(a.playerList);for(c.currentTournament=null,a.tournamentList[localStorage.current_tournament_view]&&(c.currentTournament=a.tournamentList[localStorage.current_tournament_view]),c.available_languages=Array(),c.users_language={},lang_count=0;lang_count<available_languages.length;lang_count++)available_languages[lang_count].active&&(language_object={id:available_languages[lang_count].short_code,label:available_languages[lang_count].native_name},c.available_languages.push(language_object),localStorage.users_preferred_language==available_languages[lang_count].short_code&&(c.users_language=language_object,c.background_image_url="url(images/flags/64/"+available_languages[lang_count].icon_file+")"));c.chargen_pdf_layout=localStorage.users_chargen_pdf_layout,c.updateLanguage=function(a){for(b.use(c.users_language.id),localStorage.users_preferred_language=c.users_language.id,lang_count=0;lang_count<available_languages.length;lang_count++)available_languages[lang_count].active&&localStorage.users_preferred_language==available_languages[lang_count].short_code&&(c.background_image_url="url(images/flags/64/"+available_languages[lang_count].icon_file+")");d.reload()},c.updateChargenPDF=function(a){localStorage.users_chargen_pdf_layout=a,c.chargen_pdf_layout=a,d.reload()}}];angular.module("webApp").controller("settingsController",settingsArray),angular.module("cordovaApp").controller("settingsController",settingsArray);var welcomeArray=["$rootScope","$translate","$scope",function(a,b,c){b(["APP_TITLE","INDEX_WELCOME"]).then(function(b){a.title_tag=b.INDEX_WELCOME+" | "+b.APP_TITLE,a.subtitle_tag="&raquo; "+b.INDEX_WELCOME}),c.currentWelcomePage=!0,a.playerList=getPlayersFromLocalStorage(),a.tournamentList=getTournamentsFromLocalStorage();for(var d=0;d<a.tournamentList.length;d++)a.tournamentList[d].createPlayerObjs(a.playerList);c.currentTournament=null,a.tournamentList[localStorage.current_tournament_view]&&(c.currentTournament=a.tournamentList[localStorage.current_tournament_view])}];angular.module("webApp").controller("welcomeController",welcomeArray),angular.module("cordovaApp").controller("welcomeController",welcomeArray),available_languages.push({english_name:"German",native_name:"Deutsch",icon_file:"DE.png",short_code:"de-DE",active:!0,translations:{}}),available_languages.push({english_name:"English",native_name:"English",icon_file:"US.png",short_code:"en-US",active:!0,translations:{APP_TITLE:"Tournament Tracker",INDEX_WELCOME:"Welcome",INDEX_H3_CORE:"Tournament Tracker",MENU_TITLE_HOME:"Click here to go home",MENU_TITLE_MANAGE_PLAYERS:"Click here go to player management",MENU_TITLE_MANAGE_TOURNAMENTS:"Click here to go to tournament management",MENU_TITLE_SETTINGS:"Click here to change settings",MENU_TITLE_CREDITS:"Click here to view the credits and help",MENU_TITLE_EXPORT_PLAYERS:"Click here to import and/or export players",MENU_TITLE_ADD_PLAYER:"Click here to add a player",MENU_TITLE_EXPORT_TOURNAMENTS:"Click here to import and/or export tournaments",MENU_TITLE_ADD_TOURNAMENT:"Click here to add a tournament",MENU_TITLE_CURRENT_TOURNAMENT:"Click here to return to your in-progress tournament",GENERAL_SELECT_LANGUAGE:"Select Langage",GENERAL_SETTINGS:"Settings",GENERAL_CREDITS:"Credits",GENERAL_COPYRIGHT:"Copyright",GENERAL_WELCOME:"Welcome",GENERAL_POINTS:"Points",GENERAL_POINT:"Point",GENERAL_POINT_VALUE:"Point Value",GENERAL_RULES:"Rules",GENERAL_GROUP:"Group",GENERAL_SKILL:"Skill",GENERAL_NAME:"Name",GENERAL_ALL:"All",GENERAL_SEARCH:"Search",GENERAL_SEARCH_RESULTS:"Search Results",GENERAL_CANCEL:"Cancel",GENERAL_ACTIVE:"Active",GENERAL_DOWNLOAD:"Download",GENERAL_IMPORT:"Import",GENERAL_EXPORT:"Export",GENERAL_SAVE:"Save",GENERAL_ADD:"Add",GENERAL_PLAYER:"Player",GENERAL_ITEM_RESTORE:"Restore",GENERAL_BYE:"Bye",GENERAL_TOTAL:"Total",GENERAL_ITEM_EDIT:"Edit Item",GENERAL_ITEM_REMOVE:"Remove Item",GENERAL_YES:"Yes",GENERAL_NO:"No",GENERAL_SAVE:"Save",GENERAL_CLOSE:"Close",GENERAL_NAME_FIRST:"First Name",GENERAL_NAME_LAST:"Last Name",GENERAL_NAME_NICK:"Nickname",GENERAL_PHONE:"Phone",GENERAL_PHONE_NUMBER:"Phone NUmber",GENERAL_EMAIL:"Email",GENERAL_EMAIL_ADDRESS:"Email Address",GENERAL_IMPORT_EXPORT_EXPLANATION:"Use this import/export function to transfer data from one device to another.",GENERAL_INTRODUCTORY:"Introductory",GENERAL_STANDARD:"Standard",GENERAL_ADVANCED:"Advanced",GENERAL_CLOSE:"Close",GENERAL_ERROR:"Error",GENERAL_CREATED:"Created",GENERAL_UPDATED:"Updated",GENERAL_FINISHED:"Finished",GENERAL_FINISHED:"Deleted",GENERAL_ID:"ID",GENERAL_ROUND:"Round",GENERAL_RESET:"Reset",GENERAL_NOT_ENTERED:"Not Entered",GENERAL_WIN:"Win",GENERAL_DRAW:"Draw",GENERAL_LOSS:"Loss",GENERAL_ROTATE_TO_LANDSCAPE:"Please rotate your device to landscape for optimal viewing",BUTTON_LANG_EN:"English",BUTTON_LANG_DE:"German",BUTTON_LANG_BR:"Brazilian",PLAYERS_DELETE_CONFIRMATION:"Are you sure you want to delete this player?",PLAYERS_IMPORT_INSTRUCTIONS:"To import players into this app, navigate to your Players.json file you have saved.",PLAYERS_DOWNLOAD_INSTRUCTIONS:"Click on the button below to download the current Players data object",PLAYERS_RETURN_TO_MANAGE:"Return to Player Management",PLAYERS_DELETED_PLAYERS:"Deleted Players",PLAYERS_NO_PLAYERS:"There are no players here. Add one by pressing the + at the top of the screen.",PLAYERS_NO_DELETED_PLAYERS:"There are no deleted players",PLAYERS_IMPORT_OVERWRITE_INSTRUCTIONS:"If you have an import file with existing Player IDs, then check here to create new IDs for players in the import file.<br /><strong>Warning</strong>: If you do not check this, any existing Player IDs in the import file will overwrite your existing Player Data.",TOURNAMENTS_DELETE_CONFIRMATION:"Are you sure you want to delete this tournament?",TOURNAMENTS_IMPORT_INSTRUCTIONS:"To import tournaments into this app, navigate to your Tournaments.json file you have saved. <strong>Be sure that your Players.json and Tournaments.json match, otherwise you may have orphan or wrong players!</strong>",TOURNAMENTS_TYPE:"Tournament Type",TOURNAMENTS_DOWNLOAD_INSTRUCTIONS:"Click on the button below to download the current Tournaments data object",TOURNAMENTS_NAME:"Tournament Name",TOURNAMENTS_NUM_PLAYERS:"# Players",TOURNAMENTS_EDIT_PLAYERS:"Edit Players",TOURNAMENTS_BASE_SCORING:"Base Scoring",TOURNAMENTS_EXTRA_SCORING:"Extra Scoring",TOURNAMENT_CONTROL_POINTS:"Control Points",TOURNAMENT_ARMY_POINTS:"Army Points",TOURNAMENTS_MATCHUP_SETTINGS:"Matchup Settings",TOURNAMENTS_MATCHUP_ORDERING:"Matchup Ordering",TOURNAMENTS_MATCHUP_NO_DUPLICATES:"No duplicate matchups, if possible",TOURNAMENTS_MATCHUP_HIGHEST_RANKING:"Highest Ranking",TOURNAMENTS_MATCHUP_RANDOM:"Random",TOURNAMENTS_SWISS:"Swiss",TOURNAMENTS_STEAMROLLER:"Steamroller",TOURNAMENTS_STEAMROLLER_NO_OPTIONS:"Privateer Presse's Steamroller 2016 is quite illicit on how many rounds, how to score, etc. Thankfully because of this, there are no options. Just press the Add button below to add players.",TOURNAMENTS_PLAYERS:"Players",TOURNAMENT_SWAP_LOG:"Automatic Player Swap Log",TOURNAMENTS_GENERAL_SETTINGS:"General Settings",TOURNAMENTS_POINTS_FOR_WIN:"Points for Win",TOURNAMENTS_POINTS_FOR_DRAW:"Points for Draw",TOURNAMENTS_POINTS_FOR_LOSS:"Points for Loss",TOURNAMENTS_POINTS_FOR_BYE:"Points for Bye",TOURNAMENTS_BYE_IS_AVERAGE:"Bye is Average",TOURNAMENTS_SCORING_PAINT:"Score Painting",TOURNAMENTS_SCORING_COMP:"Score Army Composition",TOURNAMENTS_SCORING_SPORTSMANSHIP:"Score Sportsmanship",TOURNAMENTS_SPORTSMANSHIP_PER_GAME:"Sportsmanship tracked per game",TOURNAMENTS_SPORTSMANSHIP_WARN:"Warn if Player receives the following number of negative sportsmanship marks",TOURNAMENTS_PLAYERS_PARTCIPATING:"Participating Players",TOURNAMENTS_PLAYERS_AVAILABLE:"Available Players",TOURNAMENTS_GO_TO_PLAYERS:"Go To Players",TOURNAMENTS_NO_AVAILABLE_PLAYERS:"There are no available players to add. Please visit the Player Adminsitration screen to add players.",TOURNAMENTS_NO_PLAYERS:"There are no players in this tournament",TOURNAMENTS_NUMBER_OF_ROUNDS:"Number of Rounds",TOURNAMENTS_NO_TOURNAMENTS:"There are no tournaments here. Add one by pressing the + at the top of the screen.",TOURNAMENT_IN_PLAY:"Tournament In-Play",TOURNAMENT_NO_CURRENT_TOURNAMENT:"For some reason the tournament that you're trying to reach has been either removed or moved on this device. Please select the Tournament icon above then 'play' an existing tournament",TOURNAMENT_BASE_SCORE:"Base Score",TOURNAMENT_FINAL_SCORE:"Final Score",TOURNAMENT_PAINTING_SCORE:"Painting Score",TOURNAMENT_COMPOSITION_SCORE:"Comp Score",TOURNAMENT_SPORTSMANSHIP_SCORE:"Sports Score",TOURNAMENT_EDIT_PAINTING_SCORE:"Editing Painting Score",TOURNAMENT_EDIT_COMPOSITION_SCORE:"Editing Comp Score",TOURNAMENT_EDIT_SPORTSMANSHIP_SCORE:"Editing Sports Score",TOURNAMENT_CURRENT_ROUND:"Current Round:",TOURNAMENT_NA:"n/a",TOURNAMENT_NE:"n/e",TOURNAMENT_NOT_AVAILABLE:"not available",TOURNAMENT_NOT_ENTERED:"not entered",TOURNAMENTS_FINISHED:"Finished",TOURNAMENTS_ROUND_NO:"Round #",TOURNAMENT_PRE_SETUP:"Pre-Setup",TOURNAMENT_FINAL_ROUND:"Final Round",TOURNAMENT_START_FIRST_ROUND:"Start First Round",TOURNAMENT_START_NEXT_ROUND:"Start Next Round",TOURNAMENT_START_LAST_ROUND:"Start Last Round",TOURNAMENT_ROUND_MATCHUPS:"Round Matchups",TOURNAMENT_TABLE_NUMBER:"Table Number",TOURNAMENT_PLAYER_1:"Player 1",TOURNAMENT_PLAYER_2:"Player 2",TOURNAMENT_START_ROUND:"Start Next Round",TOURNAMENT_CLOSE_TOURNAMENT:"Close Tournament",TOURNAMENT_COMPLETE_TOURNAMENT:"Complete Tournament",TOURNAMENT_GAME_IS_BYE:"Game is a bye",TOURNAMENT_START_FINAL_ROUND:"Start Final Round",TOURNAMENT_EDITING_GAME_SCORES:"Editing Game Scores",TOURNAMENT_EXTRA_POINTS:"Extra Points",TOURNAMENT_SWAP:"Swap",TOURNAMENT_CHOOSE_PLAYER_TO_SWAP:"Choose player to swap.",TOURNAMENT_CANCEL_SWAP:"Cancel Swap Mode",WELCOME_BUTTON_MANAGE_PLAYERS:"Manage Players",WELCOME_BUTTON_MANAGE_PLAYERS_DESC:"Before you can actually set up a tournament, you'll probably need to add some players here.",WELCOME_BUTTON_MANAGE_TOURNAMENTS:"Manage Tourmaments",WELCOME_BUTTON_MANAGE_TOURNAMENTS_DESC:"In this area you'll find your past tournaments you've tracked on this device."}});
//# sourceMappingURL=sourcemap.map