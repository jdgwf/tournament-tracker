function generateUUID(){var a=(new Date).getTime();window.performance&&"function"==typeof window.performance.now&&(a+=performance.now());var b="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(b){var c=(a+16*Math.random())%16|0;return a=Math.floor(a/16),("x"==b?c:3&c|8).toString(16)});return b}function getPlayersFromLocalStorage(){if(localStorage.players_list){for(var a=Array(),b=JSON.parse(localStorage.players_list),c=0;c<b.length;c++){var d=new Player(b[c]);a.push(d)}return a.sort(sortByNames),a}return localStorage.players_list="[]",Array()}function getTournamentsFromLocalStorage(a){if(localStorage.tournaments_list){for(var b=Array(),c=JSON.parse(localStorage.tournaments_list),d=0;d<c.length;d++){var e=new Tournament(c[d]);b.push(e)}return b}return localStorage.tournaments_list="[]",Array()}function savePlayersToLocalStorage(a){a.sort(sortByNames),localStorage.players_list=JSON.stringify(a)}function saveTournamentsToLocalStorage(a,b){console.log(a);for(var c=0;c<a.length;c++)a[c].playerObjs&&delete a[c].playerObjs;localStorage.tournaments_list=JSON.stringify(a);for(var c=0;c<a.length;c++)a[c].createPlayerObjs(b)}function getPlayerByID(a,b){for(var c=0;c<a.length;c++)if(a[c].id==b)return a[c];return null}function getPlayerIndexByID(a,b){for(var c=0;c<a.length;c++)if(a[c].id==b)return c;return-1}function getNextPlayerID(a){maxID=0;for(var b=0;b<a.length;b++)a[b].id>maxID&&(maxID=a[b].id);return maxID+1}function sortByNames(a,b){return a.name.last<b.name.last?-1:a.name.last>b.name.last?1:a.name.first<b.name.first?-1:a.name.first>b.name.first?1:a.name.nick<b.name.nick?-1:a.name.nick>b.name.nick?1:0}function formatDate(a){var b=require("dateformat");return b(a,"dddd, mmmm dS, yyyy, h:MM:ss TT")}function Player(a){this.name={first:"",last:"",nick:""},this.email="",this.phone1="",this.created=new Date,this.updated=new Date,this.active=!0,this.deleted=!1,this.id=-1,"undefined"!=typeof a&&("undefined"!=typeof a.email&&(this.name={first:a.name.first.trim(),last:a.name.last.trim(),nick:a.name.nick.trim()}),"undefined"!=typeof a.created&&(this.created=new Date(a.created)),"undefined"!=typeof a.updated&&(this.updated=new Date(a.updated)),"undefined"!=typeof a.email&&(this.email=a.email),"undefined"!=typeof a.phone1&&(this.phone1=a.phone1),"undefined"!=typeof a.active&&(this.active=a.active),"undefined"!=typeof a.deleted&&(this.deleted=a.deleted),"undefined"!=typeof a.id&&(this.id=a.id)),this.newFunction=function(){}}function Tournament(a,b){this.players=Array(),this.playerObjs=Array(),this.name="",this.numberOfRounds=4,this.pointsForWin=2,this.pointsForDraw=1,this.pointsForLoss=0,this.pointsForBye=1,this.byeIsAverage=!0,this.scoringPaint=!1,this.scoringComp=!1,this.scoringSportsmanship=!1,this.created=new Date,this.updated=new Date,this.completed=!1,this.trackPerGameSportsmanship=!0,this.warnSportsmanship=2,this.scoring=this.extraPoints=Array(),this.pointsPainting=Array(),this.pointsComposition=Array(),this.pointsSportsmanship=Array(),this.currentRound=0,this.matches=Array(),this.createPlayerObjs=function(a){this.playerObjs=Array();for(var b=0;b<this.players.length;b++){var c=getPlayerByID(a,this.players[b]);c&&this.playerObjs.push(c)}for(var d=0;d<this.numberOfRounds;d++){"undefined"==typeof this.scoring[d]&&(this.scoring[d]=Array());for(var b=0;b<this.playerObjs.length;b++)"undefined"==typeof this.scoring[d][this.playerObjs[b].id]&&(this.scoring[d][this.playerObjs[b].id]=-1),"undefined"==typeof this.pointsPainting[this.playerObjs[b].id]&&(this.pointsPainting[this.playerObjs[b].id]=-1),"undefined"==typeof this.pointsComposition[this.playerObjs[b].id]&&(this.pointsComposition[this.playerObjs[b].id]=-1),"undefined"==typeof this.pointsSportsmanship[this.playerObjs[b].id]&&(this.pointsSportsmanship[this.playerObjs[b].id]=-1)}},this.calculateResults=function(){this.totals=Array();for(var a=0;a<this.playerObjs.length;a++){numByes=0,playerTotal=0;for(var b=0;b<this.scoring;b++)"bye"!=this.scoring[b][this.playerObjs[a].id]&&this.scoring[b][this.playerObjs[a].id]>-1&&(playerTotal+=this.scoring[b][this.playerObjs[a].id]),"bye"!=this.scoring[b][this.playerObjs[a].id]&&(this.byeIsAverage||(playerTotal+=this.pointsForBye),numByes++);this.byeIsAverage&&numByes>0&&this.currentRound>1&&(averageRound=Math.round(playerTotal/(this.numberOfRounds-numByes)),playerTotal+=averageRound*numByes),this.totals[this.playerObjs[a].id]=playerTotal,this.playerObjs[a].pointsBase=playerTotal,this.playerObjs[a].pointsFinal=this.playerObjs[a].pointsBase,this.pointsPainting[this.playerObjs[a].id]>0&&(this.playerObjs[a].pointsFinal+=this.pointsPainting[this.playerObjs[a].id]),this.pointsComposition[this.playerObjs[a].id]>0&&(this.playerObjs[a].pointsFinal+=this.pointsComposition[this.playerObjs[a].id]),this.pointsSportsmanship[this.playerObjs[a].id]>0&&(this.playerObjs[a].pointsFinal+=this.pointsSportsmanship[this.playerObjs[a].id])}},"undefined"!=typeof a&&(this.players=a.players,this.name=a.name,"undefined"!=typeof a.currentRound&&(this.currentRound=a.currentRound),"undefined"!=typeof a.matches&&(this.matches=a.matches),"undefined"!=typeof a.created&&(this.created=new Date(a.created)),"undefined"!=typeof a.updated&&(this.updated=new Date(a.updated)),"undefined"!=typeof a.completed&&(this.completed=a.completed),"undefined"!=typeof a.scoring&&(this.scoring=a.scoring),"undefined"!=typeof a.extraPoints&&(this.extraPoints=a.extraPoints),"undefined"!=typeof a.pointsPainting&&(this.pointsPainting=a.pointsPainting),"undefined"!=typeof a.pointsComposition&&(this.pointsComposition=a.pointsComposition),"undefined"!=typeof a.pointsSportsmanship&&(this.pointsSportsmanship=a.pointsSportsmanship),"undefined"!=typeof a.numberOfRounds&&(this.numberOfRounds=a.numberOfRounds),"undefined"!=typeof a.pointsForWin&&(this.pointsForWin=a.pointsForWin),"undefined"!=typeof a.pointsForDraw&&(this.pointsForDraw=a.pointsForDraw),"undefined"!=typeof a.pointsForLoss&&(this.pointsForLoss=a.pointsForLoss),"undefined"!=typeof a.pointsForBye&&(this.pointsForBye=a.pointsForBye),"undefined"!=typeof a.byeIsAverage&&(this.byeIsAverage=a.byeIsAverage),"undefined"!=typeof a.scoringPaint&&(this.scoringPaint=a.scoringPaint),"undefined"!=typeof a.scoringComp&&(this.scoringComp=a.scoringComp),"undefined"!=typeof a.scoringSportsmanship&&(this.scoringSportsmanship=a.scoringSportsmanship),"undefined"!=typeof a.trackPerGameSportsmanship&&(this.trackPerGameSportsmanship=a.trackPerGameSportsmanship),"undefined"!=typeof a.warnSportsmanship&&(this.warnSportsmanship=a.warnSportsmanship)),"undefined"!=typeof b&&this.createPlayerObjs(b)}var globalRoutes=["$routeProvider","$translateProvider",function(a,b,c,d){for(lang_count=0;lang_count<available_languages.length;lang_count++)available_languages[lang_count].active&&b.translations(available_languages[lang_count].short_code,available_languages[lang_count].translations);b.useSanitizeValueStrategy("sanitize"),preferred_language="en-US",localStorage&&localStorage["tmp.preferred_language"]?preferred_language=localStorage["tmp.preferred_language"]:localStorage["tmp.preferred_language"]="en-US",b.preferredLanguage(preferred_language),a.when("/",{templateUrl:"pages/welcome.html",controller:"welcomeController"}).when("/credits",{templateUrl:"pages/credits.html",controller:"creditsController"}).when("/settings",{templateUrl:"pages/settings.html",controller:"settingsController"}).when("/players-manage",{templateUrl:"pages/players-manage.html",controller:"controllerPlayersManage"}).when("/players-deleted",{templateUrl:"pages/players-deleted.html",controller:"controllerPlayersManage"}).when("/tournaments-manage",{templateUrl:"pages/tournaments-manage.html",controller:"controllerTourmamentsManage"}).when("/tournaments-run",{templateUrl:"pages/tournaments-run.html",controller:"controllerTourmamentsRun"})}],available_languages=[],appVersion="0.01Alpha";cordovaApp=angular.module("cordovaApp",["ngRoute","ngResource","ngSanitize","pascalprecht.translate","as.sortable","mm.foundation"],globalRoutes),angular.module("cordovaApp").controller("select_language",["$translate","$scope","$route",function(a,b,c){b.change_language=function(b){a.use(b),localStorage["tmp.preferred_language"]=b,c.reload()}}]),cordovaApp.config(["$compileProvider",function(a){a.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|tel|file|blob):/)}]);var available_languages=[],appVersion="0.01Alpha";webApp=angular.module("webApp",["ngRoute","ngResource","ngSanitize","pascalprecht.translate","as.sortable","mm.foundation"],globalRoutes),angular.module("webApp").controller("select_language",["$translate","$scope","$route",function(a,b,c){b.change_language=function(b){a.use(b),localStorage["tmp.preferred_language"]=b,c.reload()}}]),webApp.config(["$compileProvider",function(a){a.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|tel|file|blob):/)}]);var class_dice=function(){};class_dice.prototype={init:function(){this.always_exploding_dice=!1,this.roll_set_count_rolls=[],this.roll_set_count=0,this.label_no_effect="No Effect",this.label_shaken="Shaken",this.label_shaken_and_a_wound="Shaken and a wound",this.label_shaken_and_x_wounds="Shaken and {raises} wounds",this.label_critical_failure="Critical Failure",this.label_failure="Failure",this.label_success="Success",this.label_success_with_a_raise="Success with a raise",this.label_success_with_x_raises="Success with {raises} raises",this.label_die_roll_number="die roll #",this.label_wild_die_roll_number="wild die roll #",this.label_roll_set_number="Roll Set #",this.label_total_roll="Total Roll",this.success_target_number=4,this.success_base_toughness=5,this.success_armor=1,this.success_weapons_ap=0},roll_die:function(a,b,c){for(a||(a=6),total_roll=0,keep_rolling=1,display_roll="";keep_rolling>0;)roll=Math.floor(Math.random()*a)+1,b>0&&roll==a?keep_rolling=1:keep_rolling=0,display_roll+=roll+", ",total_roll+=roll;if(this.roll_set_count_rolls[this.roll_set_count].base_rolls.push(display_roll),this.roll_set_count_rolls[this.roll_set_count].base_roll_sides.push(a),wild_display_roll="",totalwild_dieRoll=0,keep_rolling=1,c>0)for(a=6;keep_rolling>0;)roll=Math.floor(Math.random()*a)+1,b>0&&roll==a?keep_rolling=1:keep_rolling=0,totalwild_dieRoll+=roll,wild_display_roll+=roll+", ";return this.roll_set_count_rolls[this.roll_set_count].wild_die_rolls.push(wild_display_roll),1==totalwild_dieRoll&&1==total_roll?this.roll_set_count_rolls[this.roll_set_count].critical_failure=1:this.roll_set_count_rolls[this.roll_set_count].critical_failure=0,totalwild_dieRoll>total_roll?totalwild_dieRoll:total_roll},roll_dice:function(a,b){var c=0;number_of_sides=6,a.indexOf("*")>0?wild_die=1:wild_die=0,number_of_sides<2&&(number_of_sides=2),a=a.replace("*",""),explodingDice=0,a.indexOf("d")>-1?(rollNumber=a.substring(0,a.indexOf("d"))/1,number_of_sides=a.substring(a.indexOf("d")+1)/1,this.always_exploding_dice&&(explodingDice=1)):a.indexOf("e")>-1?(explodingDice=1,rollNumber=a.substring(0,a.indexOf("e"))/1,number_of_sides=a.substring(a.indexOf("e")+1)/1):rollNumber=a,rollNumber||(rollNumber=1),number_of_sides||(number_of_sides=6);for(var d=rollNumber+"d"+number_of_sides+": ";rollNumber-- >0;)dieRoll=this.roll_die(number_of_sides,explodingDice,wild_die),c+=dieRoll,d+=dieRoll+",",this.roll_set_count_rolls[this.roll_set_count].total_rolled_dice++;return d=d.substring(0,d.length-1),d+="",c},_parse_bit:function(a){return value=0,a.indexOf("d")>-1?value=this.roll_dice(a,0):a.indexOf("e")>-1?value=this.roll_dice(a,0):value=a/1,value},_parse_roll_set:function(a){if(set_total=0,a=a.replace(/ /g,""),a=a.toLowerCase(),a=a.replace(/\+/g," + "),a=a.replace(/x/g," x "),a=a.replace(/\//g," / "),a=a.replace(/\-/g," - "),a=a.replace(/\)/g," ) "),a=a.replace(/\(/g," ( "),a=a.replace(/\,/g," , "),this.roll_set_count_rolls[this.roll_set_count]={},this.roll_set_count_rolls[this.roll_set_count].base_rolls=[],this.roll_set_count_rolls[this.roll_set_count].wild_die_rolls=[],this.roll_set_count_rolls[this.roll_set_count].base_roll_sides=[],this.roll_set_count_rolls[this.roll_set_count].total_rolled_dice=0,this.roll_set_count_rolls[this.roll_set_count].critical_failure=0,a.indexOf(" ")>0)for(items=a.split(" "),current_function="+",count=0;count<items.length;count++)"+"!=items[count]&&"x"!=items[count]&&"-"!=items[count]&&"/"!=items[count]?"+"==current_function?set_total+=this._parse_bit(items[count])/1:"-"==current_function?set_total-=this._parse_bit(items[count])/1:"x"==current_function?0==set_total?set_total=items[count]/1:set_total=set_total*this._parse_bit(items[count])/1:"/"==current_function&&(set_total=set_total/this._parse_bit(items[count])/1):current_function=items[count];else set_total+=this._parse_bit(a);this.roll_set_count_rolls[this.roll_set_count].total_roll=set_total,this.roll_set_count++},parse_roll:function(a){if(total=0,this.roll_set_count=0,this.roll_set_count_rolls=[],a.indexOf(",")>0)for(parse_roll_items=a.split(","),parse_roll_itemcount=0;parse_roll_itemcount<parse_roll_items.length;parse_roll_itemcount++)total=this._parse_roll_set(parse_roll_items[parse_roll_itemcount]);else total+=this._parse_roll_set(a);return total},display_results:function(a,b){for(html="",results_set_count=0;results_set_count<this.roll_set_count;results_set_count++)for(this.roll_set_count>1&&(results_set_count>0&&(html+="<hr />"),html+="<h4>"+this.label_roll_set_number+(results_set_count+1)+"</h4>"),html+="<h5>"+this.label_total_roll+": "+this.roll_set_count_rolls[results_set_count].total_roll+"</h5>",a&&(html+=this.trait_success_margin(this.roll_set_count_rolls[results_set_count].total_roll,null,results_set_count)+"<br />"),b&&(html+=this.damage_success_margin(this.roll_set_count_rolls[results_set_count].total_roll)+"<br />"),current_roll=0;current_roll<this.roll_set_count_rolls[results_set_count].total_rolled_dice;current_roll++)"undefined"!=typeof this.roll_set_count_rolls[results_set_count].base_rolls[current_roll]&&(html+="<br />"+this.label_die_roll_number+(current_roll+1)+" (d"+this.roll_set_count_rolls[results_set_count].base_roll_sides[current_roll]+"): ",this.roll_set_count_rolls[results_set_count].base_rolls[current_roll]&&(this.roll_set_count_rolls[results_set_count].base_rolls[current_roll].length>2?html+=this.roll_set_count_rolls[results_set_count].base_rolls[current_roll].substring(0,this.roll_set_count_rolls[results_set_count].base_rolls[current_roll].length-2):html+=this.roll_set_count_rolls[results_set_count].base_rolls[current_roll])),"undefined"!=typeof this.roll_set_count_rolls[results_set_count].wild_die_rolls[current_roll]&&(this.roll_set_count_rolls[results_set_count].wild_die_rolls[current_roll].length>0&&(html+="<br />"+this.label_wild_die_roll_number+(current_roll+1)+" (d6): "),this.roll_set_count_rolls[results_set_count].wild_die_rolls[current_roll]&&(this.roll_set_count_rolls[results_set_count].wild_die_rolls[current_roll].length>2?html+=this.roll_set_count_rolls[results_set_count].wild_die_rolls[current_roll].substring(0,this.roll_set_count_rolls[results_set_count].wild_die_rolls[current_roll].length-2):html+=this.roll_set_count_rolls[results_set_count].wild_die_rolls[current_roll]));return html},trait_success_margin:function(a,b,c){return b||(b=this.success_target_number),value=a/1-b/1,html="","undefined"!=typeof c&&this.roll_set_count_rolls[c].critical_failure>0?html+='<span  class="color-red bolded uppercase">'+this.label_critical_failure+"</span>":value<0?html+='<span  class="color-red">'+this.label_failure+"</span>":(raises=Math.floor(value/4),0==raises?html+=this.label_success:1==raises?html+='<span  class="color-green bolded">'+this.label_success_with_a_raise+"</span>":html+='<span  class="color-green bolded uppercase">'+this.label_success_with_x_raises.replace("{raises}",raises)+"</span>"),html},set_result_margins:function(a,b,c,d){this.success_target_number=a,this.success_base_toughness=b,this.success_armor=c,this.success_weapons_ap=d},set_label:function(a,b){return"no_effect"==a?(this.label_no_effect=b,b):"total_roll"==a?(this.label_total_roll=b,b):"shaken"==a?(this.label_shaken=b,b):"shaken_and_a_wound"==a?(this.label_shaken_and_a_wound=b,b):"shaken_and_x_wounds"==a?(this.label_shaken_and_x_wounds=b,b):"critical_failure"==a?(this.label_critical_failure=b,b):"roll_set_number"==a?(this.label_roll_set_number=b,b):"failure"==a?(this.label_failure=b,b):"success"==a?(this.label_success=b,b):"success_with_a_raise"==a?(this.label_success_with_a_raise=b,b):"success_with_x_raises"==a?(this.label_success_with_x_raises=b,b):"die_roll_number"==a?(this.label_die_roll_number=b,b):"wild_die_roll_number"==a?(this.label_wild_die_roll_number=b,b):null},set_always_exploding_dice:function(a){return this.always_exploding_dice=a,this.always_exploding_dice},damage_success_margin:function(a,b,c,d){return b||(b=this.success_base_toughness),c||(c=this.success_armor),d||(d=this.success_weapons_ap),c=c/1-d/1,0>c&&(c=0),target_number=b/1+c/1,value=a/1-target_number/1,html="",value<0?html+="<span>"+this.label_no_effect+"</span>":(raises=Math.floor(value/4),0==raises?html+='<span class="color-orange">'+this.label_shaken+"</span>":1==raises?html+='<span class="color-red">'+this.label_shaken_and_a_wound+"</span>":html+='<span class="color-red bolded uppercase">'+this.label_shaken_and_x_wounds.replace("{raises}",raises)+"</span>"),html}};var creditsArray=["$rootScope","$translate","$scope",function(a,b,c){b(["APP_TITLE","INDEX_WELCOME"]).then(function(b){a.title_tag=b.INDEX_WELCOME+" | "+b.APP_TITLE,a.subtitle_tag="&raquo; "+b.INDEX_CREDITS}),c.currentCreditsPage=!0,a.playerList=getPlayersFromLocalStorage(),a.tournamentList=getTournamentsFromLocalStorage();for(var d=0;d<a.tournamentList.length;d++)a.tournamentList[d].createPlayerObjs(a.playerList);c.currentTournament=null,a.tournamentList[localStorage.current_tournament_view]&&(c.currentTournament=a.tournamentList[localStorage.current_tournament_view])}];angular.module("webApp").controller("creditsController",creditsArray),angular.module("cordovaApp").controller("creditsController",creditsArray);var playersManageArray=["$rootScope","$translate","$scope","$http",function(a,b,c,d){b(["APP_TITLE","WELCOME_BUTTON_MANAGE_PLAYERS"]).then(function(b){a.title_tag=b.WELCOME_BUTTON_MANAGE_PLAYERS+" | "+b.APP_TITLE,a.subtitle_tag="&raquo; "+b.WELCOME_BUTTON_MANAGE_PLAYERS}),c.currentPlayersPage=!0,a.playerList=getPlayersFromLocalStorage(),a.tournamentList=getTournamentsFromLocalStorage();for(var e=0;e<a.tournamentList.length;e++)a.tournamentList[e].createPlayerObjs(a.playerList);c.currentTournament=null,a.tournamentList[localStorage.current_tournament_view]&&(c.currentTournament=a.tournamentList[localStorage.current_tournament_view]),c.getNumberOfDeleted=function(){c.deletedPlayers=Array(),c.activePlayers=Array();for(var b=0;b<a.playerList.length;b++)a.playerList[b].deleted?c.deletedPlayers.push(a.playerList[b]):c.activePlayers.push(a.playerList[b]);c.numDeletedPlayers=c.deletedPlayers.length},c.getNumberOfDeleted(),c.confirmDialogQuestion="",c.showImportExportPlayerDialog=!1,c.confirmDialog=function(a,b){c.confirmDialogQuestion=a,c.showConfirmDialog=!0,c.confirmDialogYes=b},c.closeConfirmDialog=function(){c.showConfirmDialog=!1,c.confirmDialogYes=function(){c.showConfirmDialog=!1}},c.updatePlayerFirstName=function(a){c.tmpPlayer.name.first=a},c.updatePlayerLastName=function(a){c.tmpPlayer.name.last=a},c.updatePlayerNickName=function(a){c.tmpPlayer.name.nick=a},c.updatePlayerActive=function(a){c.tmpPlayer.active=a},c.updatePlayerEmail=function(a){c.tmpPlayer.email=a},c.updatePlayerPhone1=function(a){c.tmpPlayer.phone1=a},c.newPlayerDialog=function(){c.clearTempPlayerData(),c.showEditPlayerDialog=!0},c.deletePlayerDialog=function(d){b(["PLAYERS_DELETE_CONFIRMATION"]).then(function(b){c.confirmDialog(b.PLAYERS_DELETE_CONFIRMATION,function(){c.showConfirmDialog=!1;for(var b=0;b<a.playerList.length;b++)d==a.playerList[b].id&&(a.playerList[b].deleted=!0,savePlayersToLocalStorage(a.playerList),c.getNumberOfDeleted())})})},c.restorePlayerFromDelete=function(b){console.log("restorePlayerFromDelete("+b+") called"),indexNumber=getPlayerIndexByID(a.playerList,b),a.playerList[indexNumber]?(a.playerList[indexNumber].deleted=!1,savePlayersToLocalStorage(a.playerList),c.getNumberOfDeleted()):console.log("ERROR","No playerID "+b+" found!")},c.editPlayerDialog=function(b){indexNumber=getPlayerIndexByID(a.playerList,b),a.playerList[indexNumber]&&(c.tmpPlayer=angular.copy(a.playerList[indexNumber]),c.tmpPlayerIndex=indexNumber,c.showEditPlayerDialog=!0)},c.clearTempPlayerData=function(){c.tmpPlayer=new Player,c.tmpPlayerIndex=-1},c.saveEditPlayerDialog=function(){c.showEditPlayerDialog=!1,c.tmpPlayerIndex>-1?(c.tmpPlayer.updated=new Date,c.tmpPlayer.id<0&&(newID=getNextPlayerID(a.playerList),c.tmpPlayer.id=newID),a.playerList[c.tmpPlayerIndex]=new Player(c.tmpPlayer)):(newID=getNextPlayerID(a.playerList),c.tmpPlayer.created=new Date,c.tmpPlayer.updated=new Date,c.tmpPlayer.id=newID,a.playerList.push(new Player(c.tmpPlayer))),savePlayersToLocalStorage(a.playerList),c.getNumberOfDeleted(),c.clearTempPlayerData()},c.closeEditPlayerDialog=function(){c.showEditPlayerDialog=!1,c.clearTempPlayerData()},c.importExportPlayersDialog=function(){var a=JSON.stringify(c.playerList),b=new Blob([a],{type:"application/javascript"});c.downloadPlayerData=(window.URL||window.webkitURL).createObjectURL(b),c.showImportExportPlayerDialog=!0},c.closeImportExportPlayerDialog=function(){c.showImportExportPlayerDialog=!1},c.uploadFile=function(b){for(var d=new FileReader,e=0;e<b.length;e++){var f=b[e];d.onload=function(b){if(b.target&&b.target.result){var d=JSON.parse(b.target.result);if(d){objectified=Array();for(var e=0;e<d.length;e++){var f=new Player(d[e]);playerIDExists=getPlayerIndexByID(a.playerList,f.id),playerIDExists>-1?c.importAsNewPlayers?(f.id=getNextPlayerID(a.playerList),objectified.push(f)):a.playerList[playerIDExists]=f:objectified.push(f)}a.playerList=a.playerList.concat(objectified),savePlayersToLocalStorage(a.playerList),c.getNumberOfDeleted()}}},d.readAsText(f)}}}];angular.module("webApp").controller("controllerPlayersManage",playersManageArray),angular.module("cordovaApp").controller("controllerPlayersManage",playersManageArray);var tournamentsManageArray=["$rootScope","$translate","$location","$scope",function(a,b,c,d){b(["APP_TITLE","WELCOME_BUTTON_MANAGE_TOURNAMENTS"]).then(function(b){a.title_tag=b.WELCOME_BUTTON_MANAGE_TOURNAMENTS+" | "+b.APP_TITLE,a.subtitle_tag="&raquo; "+b.WELCOME_BUTTON_MANAGE_TOURNAMENTS}),d.currentTournamentsPage=!0,a.playerList=getPlayersFromLocalStorage(),a.tournamentList=getTournamentsFromLocalStorage();for(var e=0;e<a.tournamentList.length;e++)a.tournamentList[e].createPlayerObjs(a.playerList);d.currentTournament=null,a.tournamentList[localStorage.current_tournament_view]&&(d.currentTournament=a.tournamentList[localStorage.current_tournament_view]),d.confirmDialogQuestion="",d.showImportExportTournamentDialog=!1,d.confirmDialog=function(a,b){d.confirmDialogQuestion=a,d.showConfirmDialog=!0,d.confirmDialogYes=b},d.closeConfirmDialog=function(){d.showConfirmDialog=!1,d.confirmDialogYes=function(){d.showConfirmDialog=!1}},d.updateTournamentName=function(a){d.tmpTournament.name=a},d.updateTournamentRounds=function(a){d.tmpTournament.numberOfRounds=a},d.updateTournamentPointsForWin=function(a){d.tmpTournament.pointsForWin=a},d.updateTournamentPointsForDraw=function(a){d.tmpTournament.pointsForDraw=a},d.updateTournamentPointsForLoss=function(a){d.tmpTournament.pointsForLoss=a},d.updateByeIsAverage=function(a){d.tmpTournament.byeIsAverage=a},d.updateTournamentPointsForBye=function(a){d.tmpTournament.pointsForBye=a},d.updateTournamentScoringPaint=function(a){d.tmpTournament.scoringPaint=a},d.updateTournamentScoringComp=function(a){d.tmpTournament.scoringComp=a},d.updateTournamentScoringSportsmanship=function(a){d.tmpTournament.scoringSportsmanship=a},d.updateTournamentTrackPerGameSportsmanship=function(a){d.tmpTournament.trackPerGameSportsmanship=a},d.updateTournamentWarnSportsmanship=function(a){d.tmpTournament.warnSportsmanship=a},d.newTournamentDialog=function(){d.clearTempTournamentData(),d.showEditTournamentDialog=!0},d.deleteTournamentDialog=function(c){b(["TOURNAMENTS_DELETE_CONFIRMATION"]).then(function(b){d.confirmDialog(b.TOURNAMENTS_DELETE_CONFIRMATION,function(){d.showConfirmDialog=!1,a.tournamentList.splice(c,1),saveTournamentsToLocalStorage(a.tournamentList,a.playerList)})})},d.editTournamentDialog=function(b){a.tournamentList[b]&&(d.tmpTournament=angular.copy(a.tournamentList[b]),d.tmpTournamentIndex=b,d.showEditTournamentDialog=!0)},d.clearTempTournamentData=function(){d.tmpTournament=new Tournament,d.tmpTournamentIndex=-1},d.saveEditTournamentDialog=function(){d.showEditTournamentDialog=!1,d.tmpTournamentIndex>-1?(d.tmpTournament.updated=new Date,a.tournamentList[d.tmpTournamentIndex]=d.tmpTournament):(newID=getNextPlayerID(a.playerList),d.tmpTournament.created=new Date,d.tmpTournament.updated=new Date,a.tournamentList.id=newID,a.tournamentList.push(d.tmpTournament)),saveTournamentsToLocalStorage(a.tournamentList,a.playerList),d.clearTempTournamentData()},d.closeEditTournamentDialog=function(){d.showEditTournamentDialog=!1,d.clearTempTournamentData()},d.showTournamentResults=function(a){alert("showTournamentResults("+a+") called - TODO")},d.showTournamentPage=function(a){localStorage.current_tournament_view=a,c.path("tournaments-run")},d.addPlayerToTournament=function(b){console.log("addPlayerToTournament("+b+") called"),d.tmpTournament.players.push(b),d.tmpTournament.createPlayerObjs(d.playerList),saveTournamentsToLocalStorage(a.tournamentList,a.playerList),d.updateAvailableParticipatingPlayers()},d.removePlayerFromTournament=function(b){console.log("removePlayerFromTournament("+b+") called");for(var c=0;c<d.tmpTournament.players.length;c++)d.tmpTournament.players[c]==b&&(d.tmpTournament.players.splice(c,1),saveTournamentsToLocalStorage(a.tournamentList,a.playerList),d.updateAvailableParticipatingPlayers())},d.updateAvailableParticipatingPlayers=function(){d.availablePlayers=Array(),d.participatingPlayers=angular.copy(d.tmpTournament.playerObjs);for(var a=0;a<d.playerList.length;a++)-1===d.tmpTournament.players.indexOf(d.playerList[a].id)&&1==d.playerList[a].active&&0==d.playerList[a].deleted&&d.availablePlayers.push(d.playerList[a]);d.availablePlayers.sort(sortByNames),d.participatingPlayers.sort(sortByNames)},d.showEditTournamentPlayersDialog=!1,d.editTournamentPlayersDialog=function(b){d.tmpTournament=a.tournamentList[b],d.updateAvailableParticipatingPlayers(),d.showEditTournamentPlayersDialog=!0},d.closeTournamentPlayersDialog=function(){d.showEditTournamentPlayersDialog=!1,d.tmpTournament=null},d.importExportTournamentsDialog=function(){for(var a=d.tournamentList,b=0;b<a.length;b++)delete a[b].playerObjs;var c=JSON.stringify(a),e=new Blob([c],{type:"application/javascript"});d.downloadTournamentData=(window.URL||window.webkitURL).createObjectURL(e),d.showImportExportTournamentDialog=!0,console.log("importExportTournamentsDialog - $scope.showImportExportTournamentDialog",d.showImportExportTournamentDialog)},d.closeImportExportTournamentDialog=function(){d.showImportExportTournamentDialog=!1,console.log("closeImportExportTournamentDialog - $scope.showImportExportTournamentDialog",d.showImportExportTournamentDialog)},d.uploadFile=function(b){console.log("files",b);for(var c=new FileReader,d=0;d<b.length;d++){var e=b[d];c.onload=function(b){if(b.target&&b.target.result){var c=JSON.parse(b.target.result);if(c){objectified=Array();for(var d=0;d<c.length;d++){var e=new Tournament(c[d]);objectified.push(e)}a.tournamentList=a.tournamentList.concat(objectified),saveTournamentsToLocalStorage(a.tournamentList,a.playerList)}}},c.readAsText(e)}}}];angular.module("webApp").controller("controllerTourmamentsManage",tournamentsManageArray),angular.module("cordovaApp").controller("controllerTourmamentsManage",tournamentsManageArray);var tournamentsRunArray=["$rootScope","$translate","$location","$scope",function(a,b,c,d){b(["APP_TITLE","WELCOME_BUTTON_MANAGE_TOURNAMENTS"]).then(function(b){a.title_tag=b.WELCOME_BUTTON_MANAGE_TOURNAMENTS+" | "+b.APP_TITLE,a.subtitle_tag="&raquo; "+b.WELCOME_BUTTON_MANAGE_TOURNAMENTS}),d.currentTournamentsRun=!0,a.playerList=getPlayersFromLocalStorage(),a.tournamentList=getTournamentsFromLocalStorage();for(var e=0;e<a.tournamentList.length;e++)a.tournamentList[e].createPlayerObjs(a.playerList);d.currentTournament=null,a.tournamentList[localStorage.current_tournament_view]&&(d.currentTournament=a.tournamentList[localStorage.current_tournament_view]),d.currentTournament.calculateResults(),d.editScore=function(a,b){console.log("editScore("+a+", "+b+")")},d.editPaintingScore=function(a){console.log("editPaintingScore("+a+")")},d.editCompositionScore=function(a){console.log("editCompositionScore("+a+")")},d.editSportsmanshipScore=function(a){console.log("editSportsmanshipScore("+a+")")}}];angular.module("webApp").controller("controllerTourmamentsRun",tournamentsRunArray),angular.module("cordovaApp").controller("controllerTourmamentsRun",tournamentsRunArray);var settingsArray=["$rootScope","$translate","$scope","$route",function(a,b,c,d){b(["APP_TITLE","GENERAL_SETTINGS"]).then(function(b){a.title_tag=b.GENERAL_SETTINGS+" | "+b.APP_TITLE,a.subtitle_tag=b.GENERAL_SETTINGS}),c.currentSettingsPage=!0,a.playerList=getPlayersFromLocalStorage(),a.tournamentList=getTournamentsFromLocalStorage();for(var e=0;e<a.tournamentList.length;e++)a.tournamentList[e].createPlayerObjs(a.playerList);for(c.currentTournament=null,a.tournamentList[localStorage.current_tournament_view]&&(c.currentTournament=a.tournamentList[localStorage.current_tournament_view]),c.available_languages=Array(),c.users_language={},lang_count=0;lang_count<available_languages.length;lang_count++)available_languages[lang_count].active&&(language_object={id:available_languages[lang_count].short_code,label:available_languages[lang_count].native_name},c.available_languages.push(language_object),localStorage.users_preferred_language==available_languages[lang_count].short_code&&(c.users_language=language_object,c.background_image_url="url(images/flags/64/"+available_languages[lang_count].icon_file+")"));c.chargen_pdf_layout=localStorage.users_chargen_pdf_layout,c.updateLanguage=function(a){for(b.use(c.users_language.id),localStorage.users_preferred_language=c.users_language.id,lang_count=0;lang_count<available_languages.length;lang_count++)available_languages[lang_count].active&&localStorage.users_preferred_language==available_languages[lang_count].short_code&&(c.background_image_url="url(images/flags/64/"+available_languages[lang_count].icon_file+")");d.reload()},c.updateChargenPDF=function(a){localStorage.users_chargen_pdf_layout=a,c.chargen_pdf_layout=a,d.reload()}}];angular.module("webApp").controller("settingsController",settingsArray),angular.module("cordovaApp").controller("settingsController",settingsArray);var welcomeArray=["$rootScope","$translate","$scope",function(a,b,c){b(["APP_TITLE","INDEX_WELCOME"]).then(function(b){a.title_tag=b.INDEX_WELCOME+" | "+b.APP_TITLE,a.subtitle_tag="&raquo; "+b.INDEX_WELCOME}),c.currentWelcomePage=!0,a.playerList=getPlayersFromLocalStorage(),a.tournamentList=getTournamentsFromLocalStorage();for(var d=0;d<a.tournamentList.length;d++)a.tournamentList[d].createPlayerObjs(a.playerList);c.currentTournament=null,a.tournamentList[localStorage.current_tournament_view]&&(c.currentTournament=a.tournamentList[localStorage.current_tournament_view])}];angular.module("webApp").controller("welcomeController",welcomeArray),angular.module("cordovaApp").controller("welcomeController",welcomeArray),available_languages.push({english_name:"German",native_name:"Deutsch",icon_file:"DE.png",short_code:"de-DE",active:!0,translations:{}}),available_languages.push({english_name:"English",native_name:"English",icon_file:"US.png",short_code:"en-US",active:!0,translations:{APP_TITLE:"@Gauthic's Tournament Tracker",INDEX_WELCOME:"Welcome",INDEX_H3_CORE:"@Gauthic's Tournament Tracker",
MENU_TITLE_HOME:"Click here to go home",MENU_TITLE_MANAGE_PLAYERS:"Click here go to player management",MENU_TITLE_MANAGE_TOURNAMENTS:"Click here to go to tournament management",MENU_TITLE_SETTINGS:"Click here to change settings",MENU_TITLE_CREDITS:"Click here to view the credits and help",MENU_TITLE_EXPORT_PLAYERS:"Click here to import and/or export players",MENU_TITLE_ADD_PLAYER:"Click here to add a player",MENU_TITLE_EXPORT_TOURNAMENTS:"Click here to import and/or export tournaments",MENU_TITLE_ADD_TOURNAMENT:"Click here to add a tournament",GENERAL_SELECT_LANGUAGE:"Select Langage",GENERAL_SETTINGS:"Settings",GENERAL_CREDITS:"Credits",GENERAL_COPYRIGHT:"Copyright",GENERAL_WELCOME:"Welcome",GENERAL_POINTS:"Points",GENERAL_POINT:"Point",GENERAL_POINT_VALUE:"Point Value",GENERAL_RULES:"Rules",GENERAL_GROUP:"Group",GENERAL_SKILL:"Skill",GENERAL_NAME:"Name",GENERAL_ALL:"All",GENERAL_SEARCH:"Search",GENERAL_SEARCH_RESULTS:"Search Results",GENERAL_CANCEL:"Cancel",GENERAL_ACTIVE:"Active",GENERAL_DOWNLOAD:"Download",GENERAL_IMPORT:"Import",GENERAL_EXPORT:"Export",GENERAL_SAVE:"Save",GENERAL_ADD:"Add",GENERAL_PLAYER:"Player",GENERAL_ITEM_RESTORE:"Restore",GENERAL_ITEM_EDIT:"Edit Item",GENERAL_ITEM_REMOVE:"Remove Item",GENERAL_YES:"Yes",GENERAL_NO:"No",GENERAL_SAVE:"Save",GENERAL_CLOSE:"Close",GENERAL_NAME_FIRST:"First Name",GENERAL_NAME_LAST:"Last Name",GENERAL_NAME_NICK:"Nickname",GENERAL_PHONE:"Phone",GENERAL_PHONE_NUMBER:"Phone NUmber",GENERAL_EMAIL:"Email",GENERAL_EMAIL_ADDRESS:"Email Address",GENERAL_IMPORT_EXPORT_EXPLANATION:"Use this import/export function to transfer data from one device to another.",GENERAL_INTRODUCTORY:"Introductory",GENERAL_STANDARD:"Standard",GENERAL_ADVANCED:"Advanced",GENERAL_CLOSE:"Close",GENERAL_ERROR:"Error",GENERAL_CREATED:"Created",GENERAL_UPDATED:"Updated",GENERAL_FINISHED:"Finished",GENERAL_FINISHED:"Deleted",GENERAL_ID:"ID",GENERAL_ROTATE_TO_LANDSCAPE:"Please rotate your device to landscape for optimal viewing",BUTTON_LANG_EN:"English",BUTTON_LANG_DE:"German",BUTTON_LANG_BR:"Brazilian",PLAYERS_DELETE_CONFIRMATION:"Are you sure you want to delete this player?",PLAYERS_IMPORT_INSTRUCTIONS:"To import players into this app, navigate to your Players.json file you have saved.",PLAYERS_DOWNLOAD_INSTRUCTIONS:"Click on the button below to download the current Players data object",PLAYERS_RETURN_TO_MANAGE:"Return to Player Management",PLAYERS_DELETED_PLAYERS:"Deleted Players",PLAYERS_NO_PLAYERS:"There are no players here. Add one by pressing the + at the top of the screen.",PLAYERS_NO_DELETED_PLAYERS:"There are no deleted players",PLAYERS_IMPORT_OVERWRITE_INSTRUCTIONS:"If you have an import file with existing Player IDs, then check here to create new IDs for players in the import file.<br /><strong>Warning</strong>: If you do not check this, any existing Player IDs in the import file will overwrite your existing Player Data.",TOURNAMENTS_DELETE_CONFIRMATION:"Are you sure you want to delete this tournament?",TOURNAMENTS_IMPORT_INSTRUCTIONS:"To import tournaments into this app, navigate to your Tournaments.json file you have saved. <strong>Be sure that your Players.json and Tournaments.json match, otherwise you may have orphan or wrong players!</strong>",TOURNAMENTS_DOWNLOAD_INSTRUCTIONS:"Click on the button below to download the current Tournaments data object",TOURNAMENTS_NAME:"Tournament Name",TOURNAMENTS_NUM_PLAYERS:"# Players",TOURNAMENTS_EDIT_PLAYERS:"Edit Players",TOURNAMENTS_BASE_SCORING:"Base Scoring",TOURNAMENTS_EXTRA_SCORING:"Extra Scoring",TOURNAMENTS_PLAYERS:"Players",TOURNAMENTS_GENERAL_SETTINGS:"General Settings",TOURNAMENTS_POINTS_FOR_WIN:"Points for Win",TOURNAMENTS_POINTS_FOR_DRAW:"Points for Draw",TOURNAMENTS_POINTS_FOR_LOSS:"Points for Loss",TOURNAMENTS_POINTS_FOR_BYE:"Points for Bye",TOURNAMENTS_BYE_IS_AVERAGE:"Bye is Average",TOURNAMENTS_SCORING_PAINT:"Score Painting",TOURNAMENTS_SCORING_COMP:"Score Army Composition",TOURNAMENTS_SCORING_SPORTSMANSHIP:"Score Sportsmanship",TOURNAMENTS_SPORTSMANSHIP_PER_GAME:"Sportsmanship tracked per game",TOURNAMENTS_SPORTSMANSHIP_WARN:"Warn if Player receives the following number of negative sportsmanship marks",TOURNAMENTS_PLAYERS_PARTCIPATING:"Participating Players",TOURNAMENTS_PLAYERS_AVAILABLE:"Available Players",TOURNAMENTS_GO_TO_PLAYERS:"Go To Players",TOURNAMENTS_NO_AVAILABLE_PLAYERS:"There are no available players to add. Please visit the Player Adminsitration screen to add players.",TOURNAMENTS_NO_PLAYERS:"There are no players in this tournament",TOURNAMENTS_NUMBER_OF_ROUNDS:"Number of Rounds",TOURNAMENTS_NO_TOURNAMENTS:"There are no tournaments here. Add one by pressing the + at the top of the screen.",TOURNAMENT_IN_PLAY:"Tournament In-Play",TOURNAMENT_NO_CURRENT_TOURNAMENT:"For some reason the tournament that you're trying to reach has been either removed or moved on this device. Please select the Tournament icon above then 'play' an existing tournament",TOURNAMENT_BASE_SCORE:"Base Score",TOURNAMENT_FINAL_SCORE:"Final Score",TOURNAMENT_PAINTING_SCORE:"Painting Score",TOURNAMENT_COMPOSITION_SCORE:"Comp Score",TOURNAMENT_SPORTSMANSHIP_SCORE:"Sports Score",TOURNAMENT_CURRENT_ROUND:"Current Round:",TOURNAMENT_NA:"n/a",TOURNAMENT_NE:"n/e",TOURNAMENT_NOT_AVAILABLE:"not available",TOURNAMENT_NOT_ENTERED:"not entered",TOURNAMENTS_FINISHED:"Finished",TOURNAMENTS_ROUND_NO:"Round #",WELCOME_BUTTON_MANAGE_PLAYERS:"Manage Players",WELCOME_BUTTON_MANAGE_PLAYERS_DESC:"Before you can actually set up a tournament, you'll probably need to add some players here.",WELCOME_BUTTON_MANAGE_TOURNAMENTS:"Manage Tourmaments",WELCOME_BUTTON_MANAGE_TOURNAMENTS_DESC:"In this area you'll find your past tournaments you've tracked on this device."}});
//# sourceMappingURL=sourcemap.map