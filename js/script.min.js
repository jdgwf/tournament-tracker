function generateUUID(){var t=(new Date).getTime();return window.performance&&"function"==typeof window.performance.now&&(t+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var r=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==e?r:3&r|8).toString(16)})}function getPlayersFromLocalStorage(){if(localStorage.players_list){for(var t=Array(),e=JSON.parse(localStorage.players_list),r=0;r<e.length;r++){var a=new Player(e[r]);t.push(a)}return t.sort(sortByNames),t}return localStorage.players_list="[]",Array()}function getRandomInt(t,e){return t=Math.ceil(t),e=Math.floor(e),Math.floor(Math.random()*(e-t))+t}function getTournamentsFromLocalStorage(t){if(localStorage.tournaments_list){for(var e=Array(),r=JSON.parse(localStorage.tournaments_list),a=0;a<r.length;a++){var o=new Tournament(r[a]);e.push(o)}return e}return localStorage.tournaments_list="[]",Array()}function savePlayersToLocalStorage(t){t.sort(sortByNames),localStorage.players_list=JSON.stringify(t)}function saveTournamentsToLocalStorage(t,e){for(r=0;r<t.length;r++)t[r].playerObjs&&delete t[r].playerObjs,t[r].matchupObjs&&delete t[r].matchupObjs;localStorage.tournaments_list=JSON.stringify(t);for(var r=0;r<t.length;r++)t[r].createPlayerObjs(e),t[r].createMatchupObjs(e)}function getPlayerByID(t,e){for(var r=0;r<t.length;r++)if(t[r].id==e)return t[r];return null}function getStyledPlayerName(t){return t.name.nick?t.name.first+' "<strong>'+t.name.nick+'</strong>" '+t.name.last:"<strong>"+t.name.first+"</strong> "+t.name.last}function getPlayerIndexByID(t,e){for(var r=0;r<t.length;r++)if(t[r].id==e)return r;return-1}function getNextPlayerID(t){maxID=0;for(var e=0;e<t.length;e++)t[e].id>maxID&&(maxID=t[e].id);return maxID+1}function sortByNames(t,e){return t.name.last<e.name.last?-1:t.name.last>e.name.last?1:t.name.first<e.name.first?-1:t.name.first>e.name.first?1:t.name.nick<e.name.nick?-1:t.name.nick>e.name.nick?1:0}function sortByBaseScore(t,e){return t.pointsBase>e.pointsBase?-1:t.pointsBase<e.pointsBase?1:0}function sortByFinalScore(t,e){return t.pointsFinal>e.pointsFinal?-1:t.pointsFinal<e.pointsFinal?1:0}function steamPlayerSort(t,e){return t.pointsBase>e.pointsBase?-1:t.pointsBase<e.pointsBase?1:t.steamControlPoints>e.steamControlPoints?-1:t.steamControlPoints<e.steamControlPoints?1:t.steamArmyPoints>e.steamArmyPoints?-1:t.steamArmyPoints<e.steamArmyPoints?1:0}function formatDate(t){return require("dateformat")(t,"dddd, mmmm dS, yyyy, h:MM:ss TT")}function shuffleArray(t){for(var e,r,a=t.length;0!==a;)r=Math.floor(Math.random()*a),e=t[a-=1],t[a]=t[r],t[r]=e;return t}function Player(t){this.name={first:"",last:"",nick:""},this.email="",this.phone1="",this.created=new Date,this.updated=new Date,this.active=!0,this.deleted=!1,this.id=generateUUID(),void 0!==t&&(void 0!==t.email&&(this.name={first:t.name.first.trim(),last:t.name.last.trim(),nick:t.name.nick.trim()}),void 0!==t.created&&(this.created=new Date(t.created)),void 0!==t.updated&&(this.updated=new Date(t.updated)),void 0!==t.email&&(this.email=t.email),void 0!==t.phone1&&(this.phone1=t.phone1),void 0!==t.active&&(this.active=t.active),void 0!==t.deleted&&(this.deleted=t.deleted),"string"==typeof t.id&&t.id.length>10?this.id=t.id:this.id=generateUUID()),this.newFunction=function(){}}function Tournament(t,e){this.players=Array(),this.playerObjs=Array(),this.name="",this.numberOfRounds=4,this.pointsForWin=2,this.pointsForDraw=1,this.pointsForLoss=0,this.pointsForBye=1,this.type="swiss",this.byeIsAverage=!0,this.scoringPaint=!1,this.scoringComp=!1,this.scoringSportsmanship=!1,this.created=new Date,this.updated=new Date,this.completed=!1,this.trackPerGameSportsmanship=!0,this.warnSportsmanship=2,this.scoring=Array(),this.extraPoints={},this.steamControlPoints=[],this.steamArmyPoints=[],this.pointsPainting={},this.pointsComposition={},this.pointsSportsmanship={},this.currentRound=0,this.matches=Array(),this.noDuplicateMatchups=!0,this.matchupType="highest-ranking",this.swapLog="",this.byeType="middle",this.id=generateUUID(),this.createMatchupObjs=function(t){this.matchupObjs=Array();for(var e in this.matches)if(this.matchupObjs[e]=Array(),this.matches[e])for(var r=0;r<this.matches[e].length;r++){var a={table:this.matches[e][r].table,player1:getPlayerByID(t,this.matches[e][r].player1),player2:getPlayerByID(t,this.matches[e][r].player2)};this.matchupObjs[e].push(a)}},this.attemptToRemoveDuplicateMatches=function(t,e){if(1==t)return!1;if(0==this.noDuplicateMatchups)return!1;this.swapLog="<ul>";for(var r=null,a=null,o=1;o<this.matches[t].length;o++)if(this.hasPlayedEachOther(this.matches[t][o].player1,this.matches[t][o].player2)){r=getPlayerByID(e,this.matches[t][o].player1),a=getPlayerByID(e,this.matches[t][o].player2),this.swapLog+="<li>"+getStyledPlayerName(r)+" has played "+getStyledPlayerName(a)+"</li>\n";for(var n=o+1;n<this.matches[t].length;n++){if(!this.hasPlayedEachOther(this.matches[t][n].player1,this.matches[t][o].player1)){swapPlayer=getPlayerByID(e,this.matches[t][n].player1),origID=this.matches[t][o].player2,this.matches[t][o].player2=this.matches[t][n].player1,this.matches[t][n].player1=origID,this.swapLog+="<li><strong>SWAPPING</strong> "+getStyledPlayerName(a)+" with "+getStyledPlayerName(swapPlayer)+"</li>\n";break}if(!this.hasPlayedEachOther(this.matches[t][n].player2,this.matches[t][o].player1)){swapPlayer=getPlayerByID(e,this.matches[t][n].player1),origID=this.matches[t][o].player1,this.matches[t][o].player1=this.matches[t][n].player2,this.matches[t][n].player2=origID,this.swapLog+="<li><strong>SWAPPING</strong> "+getStyledPlayerName(r)+" with "+getStyledPlayerName(swapPlayer)+"</li>\n";break}}}"<ul>"==this.swapLog?this.swapLog="":this.swapLog+="</ul>"},this.createMatchRound=function(t,e){this.createPlayerObjs(e);Array();this.matches[t]=Array(),1==t?this.playerObjs=shuffleArray(this.playerObjs):"steamroller"==this.type?this.sortPlayerObjsByScores():"highest-ranking"==this.matchupType?this.sortPlayerObjsByScores():"random"==this.matchupType?this.playerObjs=shuffleArray(this.playerObjs):this.sortPlayerObjsByScores();var r=0,a=1,o=-1;if(this.playerObjs.length%2!=0)switch(this.byeType){case"first":o=0;break;case"middle":o=(this.playerObjs.length-1)/2;break;case"last":o=this.playerObjs.length;break;case"random":o=getRandomInt(0,this.playerObjs.length-1);break;default:o=(this.playerObjs.length-1)/2}for(;o>-1&&this.hasHadBye(this.playerObjs[o].id)&&o<this.playerObjs.length;)o++;for(var n=0,s=0,i=null,r=0;r<this.playerObjs.length;r++)if(o==r?i={table:"-",player1:this.playerObjs[r].id,player2:""}:0==n?n=this.playerObjs[r].id:0==s&&(s=this.playerObjs[r].id),0!=n&&0!=s){var l={table:a,player1:n,player2:s};this.matches[t].push(l),n=0,s=0,a++}i&&this.matches[t].push(i),this.attemptToRemoveDuplicateMatches(t,e),this.createMatchupObjs(e)},this.getScore=function(t,e){return void 0!==this.scoring[t-1]&&void 0!==this.scoring[t-1][e]?this.scoring[t-1][e]+"":"-1"},this.setScore=function(t,e,r){return void 0===this.scoring[t-1]&&(this.scoring[t-1]={}),void 0===this.scoring[t-1][e]&&(this.scoring[t-1][e]="-1"),this.scoring[t-1][e]=r,this.scoring[t-1][e]},this.getExtraPoints=function(t,e){return void 0!==this.extraPoints[t-1]&&void 0!==this.extraPoints[t-1][e]&&this.extraPoints[t-1][e]>0?this.extraPoints[t-1][e]:0},this.getSteamArmyPoints=function(t,e){return void 0!==this.steamArmyPoints[t-1]&&void 0!==this.steamArmyPoints[t-1][e]&&this.steamArmyPoints[t-1][e]>0?this.steamArmyPoints[t-1][e]:0},this.getSteamControlPoints=function(t,e){return void 0!==this.steamControlPoints[t-1]&&void 0!==this.steamControlPoints[t-1][e]&&this.steamControlPoints[t-1][e]>0?this.steamControlPoints[t-1][e]:0},this.getPaintingPoints=function(t){return this.pointsPainting[t]?this.pointsPainting[t]:0},this.setPaintingPoints=function(t,e){return this.pointsPainting[t]=e,this.pointsPainting[t]},this.getCompPoints=function(t){return this.pointsComposition[t]?this.pointsComposition[t]:0},this.setCompPoints=function(t,e){return this.pointsComposition[t]=e,this.pointsComposition[t]},this.getSportsPoints=function(t){return this.pointsSportsmanship[t]?this.pointsSportsmanship[t]:0},this.setSportsPoints=function(t,e){return this.pointsSportsmanship[t]=e,this.pointsSportsmanship[t]},this.setExtraPoints=function(t,e,r){return void 0===this.extraPoints[t-1]&&(this.extraPoints[t-1]=Array()),void 0===this.extraPoints[t-1][e]&&(this.extraPoints[t-1][e]=-1),this.extraPoints[t-1][e]=r,this.extraPoints[t-1][e]},this.setSteamArmyPoints=function(t,e,r){return void 0===this.steamArmyPoints[t-1]&&(this.steamArmyPoints[t-1]={}),void 0===this.steamArmyPoints[t-1][e]&&(this.steamArmyPoints[t-1][e]=-1),this.steamArmyPoints[t-1][e]=r,this.steamArmyPoints[t-1][e]},this.setSteamControlPoints=function(t,e,r){return void 0===this.steamControlPoints[t-1]&&(this.steamControlPoints[t-1]={}),void 0===this.steamControlPoints[t-1][e]&&(this.steamControlPoints[t-1][e]=-1),this.steamControlPoints[t-1][e]=r,this.steamControlPoints[t-1][e]},this.sortPlayerObjsByScores=function(){this.calculateResults(),"swiss"==this.type?this.playerObjs.sort(sortByBaseScore):"steamroller"==this.type&&this.playerObjs.sort(steamPlayerSort);for(var t=1,e=0;e<this.playerObjs.length;e++)this.playerObjs[e].rank=t,t++},this.hasPlayedEachOther=function(t,e){if(t==e)return!0;if(""==t||""==e)return!1;if(0==this.currentRound)return!1;if(0==this.noDuplicateMatchups)return!1;for(var r=0;r<=this.currentRound;r++)if(this.matches[r])for(var a=0;a<this.matches[r].length;a++)if(this.matches[r][a].player1&&this.matches[r][a].player1&&this.matches[r][a].player1==t&&this.matches[r][a].player2==e||this.matches[r][a].player1==e&&this.matches[r][a].player2==t)return!0;return!1},this.hasHadBye=function(t){if(0==this.currentRound)return!1;for(var e=1;e<=this.currentRound;e++)if(this.matches[e])for(var r=0;r<this.matches.length;r++)if(this.matches[e][r]&&this.matches[e][r].player1==t&&""==this.matches[e][r].player2||this.matches[e][r]&&""==this.matches[e][r].player1&&this.matches[e][r].player2==t)return!0;return!1},this.createPlayerObjs=function(t){this.playerObjs=Array();for(a=0;a<this.players.length;a++){var e=getPlayerByID(t,this.players[a]);e&&(""!=e.name.nick?e.displayName=e.name.first+' "'+e.name.nick+'" '+e.name.last:e.displayName=e.name.first+" "+e.name.last,this.playerObjs.push(e))}for(var r=0;r<this.numberOfRounds;r++){void 0===this.scoring[r]&&(this.scoring[r]={});for(var a=0;a<this.playerObjs.length;a++)void 0!==this.scoring[r][this.playerObjs[a].id]&&"-1"!=this.scoring[r][this.playerObjs[a].id]&&null!=this.scoring[r][this.playerObjs[a].id]||(this.isByeRound(r+1,this.playerObjs[a].id)?this.scoring[r][this.playerObjs[a].id]="bye":this.scoring[r][this.playerObjs[a].id]="-1"),void 0===this.pointsPainting[this.playerObjs[a].id]&&(this.pointsPainting[this.playerObjs[a].id]=-1),void 0===this.pointsComposition[this.playerObjs[a].id]&&(this.pointsComposition[this.playerObjs[a].id]=-1),void 0===this.pointsSportsmanship[this.playerObjs[a].id]&&(this.pointsSportsmanship[this.playerObjs[a].id]=-1)}this.sortPlayerObjsByScores(),"steamroller"==this.type&&(this.playerObjs.length>64?this.numberOfRounds=7:this.playerObjs.length>32?this.numberOfRounds=6:this.playerObjs.length>16?this.numberOfRounds=5:this.playerObjs.length>8?this.numberOfRounds=4:this.numberOfRounds=3,this.pointsForWin=1,this.pointsForDraw=0,this.pointsForLoss=0,this.pointsForBye=1,this.byeIsAverage=!1,this.scoringPaint=!1,this.scoringComp=!1,this.scoringSportsmanship=!1,this.byeType="middle")},this.isByeRound=function(t,e){if(this.matches[t])for(var r=0;r<this.matches[t].length;r++)if(this.matches[t][r].player1==e&&""==this.matches[t][r].player2)return!0;return!1},this.getMatch=function(t,e){if(this.matches[t])for(var r=0;r<this.matches[t].length;r++)if(this.matches[t][r].player1==e&&-1!=this.matches[t][r].player2||this.matches[t][r].player2==e)return this.matches[t][r];return null},this.swapPlayers=function(t,e,r,a){for(var o=0;o<this.matches[r].length;o++)this.matches[r][o].player1==t?this.matches[r][o].player1=e:this.matches[r][o].player1==e&&(this.matches[r][o].player1=t),this.matches[r][o].player2==t?this.matches[r][o].player2=e:this.matches[r][o].player2==e&&(this.matches[r][o].player2=t);this.createMatchupObjs(a)},this.calculateResults=function(){this.totals=Array(),this.byeSteamControlPoints=Array(),this.byeSteamArmyPoints=Array(),this.byePoints=Array();for(var t=0;t<this.playerObjs.length;t++){numByes=0,playerTotal=0,this.playerObjs[t].steamControlPoints=0,this.playerObjs[t].steamArmyPoints=0;for(var e=0;e<this.scoring.length;e++)"bye"!=this.scoring[e][this.playerObjs[t].id]&&"-1"!=this.scoring[e][this.playerObjs[t].id]&&("win"==this.scoring[e][this.playerObjs[t].id]?playerTotal+=this.pointsForWin:"loss"==this.scoring[e][this.playerObjs[t].id]?playerTotal+=this.pointsForLoss:"draw"==this.scoring[e][this.playerObjs[t].id]&&(playerTotal+=this.pointsForDraw)),this.extraPoints[e]&&this.extraPoints[e][this.playerObjs[t].id]&&this.extraPoints[e][this.playerObjs[t].id]>0&&(playerTotal+=this.extraPoints[e][this.playerObjs[t].id]),this.steamControlPoints[e]&&this.steamControlPoints[e][this.playerObjs[t].id]&&this.steamControlPoints[e][this.playerObjs[t].id]>0&&(this.playerObjs[t].steamControlPoints+=this.steamControlPoints[e][this.playerObjs[t].id]),this.steamArmyPoints[e]&&this.steamArmyPoints[e][this.playerObjs[t].id]&&this.steamArmyPoints[e][this.playerObjs[t].id]>0&&(this.playerObjs[t].steamArmyPoints+=this.steamArmyPoints[e][this.playerObjs[t].id]),"bye"==this.scoring[e][this.playerObjs[t].id]&&((0==this.byeIsAverage||this.currentRound<2)&&(playerTotal+=this.pointsForBye,this.byePoints[this.playerObjs[t].id]=this.pointsForBye),numByes++);if(1==this.byeIsAverage&&numByes>0&&this.currentRound>1&&(this.currentRound-numByes>0?(averageRound=Math.round(playerTotal/(this.currentRound-numByes)),playerTotal+=averageRound*numByes,this.byePoints[this.playerObjs[t].id]=averageRound):(playerTotal+=this.pointsForBye*numByes,this.byePoints[this.playerObjs[t].id]=0)),this.totals[this.playerObjs[t].id]=playerTotal,this.playerObjs[t].pointsBase=playerTotal,this.playerObjs[t].pointsFinal=this.playerObjs[t].pointsBase,this.pointsPainting[this.playerObjs[t].id]>0&&(this.playerObjs[t].pointsFinal+=this.pointsPainting[this.playerObjs[t].id]),this.pointsComposition[this.playerObjs[t].id]>0&&(this.playerObjs[t].pointsFinal+=this.pointsComposition[this.playerObjs[t].id]),this.pointsSportsmanship[this.playerObjs[t].id]>0&&(this.playerObjs[t].pointsFinal+=this.pointsSportsmanship[this.playerObjs[t].id]),"steamroller"==this.type)if(playerTotal>0&&this.hasHadBye(this.playerObjs[t].id)){for(var r=0,a=0,o=0;o<this.steamArmyPoints.length;o++)this.steamControlPoints[o]&&void 0!==this.steamControlPoints[o][this.playerObjs[t].id]&&null!==this.steamControlPoints[o][this.playerObjs[t].id]&&(a+=this.steamControlPoints[o][this.playerObjs[t].id],r++);r>0?(this.byeSteamControlPoints[this.playerObjs[t].id]=Math.round(a/r),this.playerObjs[t].steamControlPoints+=this.byeSteamControlPoints[this.playerObjs[t].id]):this.byeSteamControlPoints[this.playerObjs[t].id]=0;for(var r=0,a=0,o=0;o<this.steamArmyPoints.length;o++)this.steamArmyPoints[o]&&void 0!==this.steamArmyPoints[o][this.playerObjs[t].id]&&null!==this.steamArmyPoints[o][this.playerObjs[t].id]&&(a+=this.steamArmyPoints[o][this.playerObjs[t].id],r++);r>0?(this.byeSteamArmyPoints[this.playerObjs[t].id]=Math.round(a/r),this.playerObjs[t].steamArmyPoints+=this.byeSteamArmyPoints[this.playerObjs[t].id]):this.byeSteamArmyPoints[this.playerObjs[t].id]=0}else this.byeSteamControlPoints[this.playerObjs[t].id]=0,this.byeSteamArmyPoints[this.playerObjs[t].id]=0}},void 0!==t&&(this.players=t.players,this.name=t.name,void 0!==t.currentRound&&(this.currentRound=t.currentRound),void 0!==t.matches&&(this.matches=t.matches),void 0!==t.created&&(this.created=new Date(t.created)),void 0!==t.updated&&(this.updated=new Date(t.updated)),void 0!==t.completed&&(this.completed=t.completed),void 0!==t.scoring&&(this.scoring=t.scoring),void 0!==t.extraPoints&&(this.extraPoints=t.extraPoints),void 0!==t.id&&(this.id=generateUUID()),void 0!==t.pointsPainting&&(this.pointsPainting=t.pointsPainting),void 0!==t.pointsComposition&&(this.pointsComposition=t.pointsComposition),void 0!==t.pointsSportsmanship&&(this.pointsSportsmanship=t.pointsSportsmanship),void 0!==t.numberOfRounds&&(this.numberOfRounds=t.numberOfRounds),void 0!==t.pointsForWin&&(this.pointsForWin=t.pointsForWin),void 0!==t.pointsForDraw&&(this.pointsForDraw=t.pointsForDraw),void 0!==t.pointsForLoss&&(this.pointsForLoss=t.pointsForLoss),void 0!==t.pointsForBye&&(this.pointsForBye=t.pointsForBye),void 0!==t.byeIsAverage&&(this.byeIsAverage=t.byeIsAverage),void 0!==t.scoringPaint&&(this.scoringPaint=t.scoringPaint),void 0!==t.scoringComp&&(this.scoringComp=t.scoringComp),void 0!==t.scoringSportsmanship&&(this.scoringSportsmanship=t.scoringSportsmanship),void 0!==t.trackPerGameSportsmanship&&(this.trackPerGameSportsmanship=t.trackPerGameSportsmanship),void 0!==t.warnSportsmanship&&(this.warnSportsmanship=t.warnSportsmanship),void 0!==t.noDuplicateMatchups&&(this.noDuplicateMatchups=t.noDuplicateMatchups),void 0!==t.matchupType&&(this.matchupType=t.matchupType),void 0!==t.type&&(this.type=t.type),void 0!==t.byeType&&(this.byeType=t.byeType),void 0!==t.steamArmyPoints&&(this.steamArmyPoints=t.steamArmyPoints),void 0!==t.steamControlPoints&&(this.steamControlPoints=t.steamControlPoints)),void 0!==e&&this.createPlayerObjs(e)}var globalRoutes=["$routeProvider","$translateProvider",function(t,e,r,a){for(lang_count=0;lang_count<available_languages.length;lang_count++)available_languages[lang_count].active&&e.translations(available_languages[lang_count].short_code,available_languages[lang_count].translations);e.useSanitizeValueStrategy("sanitize"),preferred_language="en-US",localStorage&&localStorage["tmp.preferred_language"]?preferred_language=localStorage["tmp.preferred_language"]:localStorage["tmp.preferred_language"]="en-US",e.preferredLanguage(preferred_language),t.when("/",{templateUrl:"pages/welcome.html",controller:"welcomeController"}).when("/credits",{templateUrl:"pages/credits.html",controller:"creditsController"}).when("/settings",{templateUrl:"pages/settings.html",controller:"settingsController"}).when("/players-manage",{templateUrl:"pages/players-manage.html",controller:"controllerPlayersManage"}).when("/players-deleted",{templateUrl:"pages/players-deleted.html",controller:"controllerPlayersManage"}).when("/tournaments-manage",{templateUrl:"pages/tournaments-manage.html",controller:"controllerTourmamentsManage"}).when("/tournaments-run",{templateUrl:"pages/tournaments-run.html",controller:"controllerTourmamentsRun"})}],available_languages=[],appVersion="0.01Alpha";cordovaApp=angular.module("cordovaApp",["ngRoute","ngResource","ngSanitize","pascalprecht.translate","as.sortable","mm.foundation"],globalRoutes),angular.module("cordovaApp").controller("select_language",["$translate","$scope","$route",function(t,e,r){e.change_language=function(e){t.use(e),localStorage["tmp.preferred_language"]=e,r.reload()}}]),cordovaApp.config(["$compileProvider",function(t){t.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|tel|file|blob):/)}]);var available_languages=[],appVersion="0.01Alpha";webApp=angular.module("webApp",["ngRoute","ngResource","ngSanitize","pascalprecht.translate","as.sortable","mm.foundation"],globalRoutes),angular.module("webApp").controller("select_language",["$translate","$scope","$route",function(t,e,r){e.change_language=function(e){t.use(e),localStorage["tmp.preferred_language"]=e,r.reload()}}]),webApp.config(["$compileProvider",function(t){t.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|tel|file|blob):/)}]);var class_dice=function(){};class_dice.prototype={init:function(){this.always_exploding_dice=!1,this.roll_set_count_rolls=[],this.roll_set_count=0,this.label_no_effect="No Effect",this.label_shaken="Shaken",this.label_shaken_and_a_wound="Shaken and a wound",this.label_shaken_and_x_wounds="Shaken and {raises} wounds",this.label_critical_failure="Critical Failure",this.label_failure="Failure",this.label_success="Success",this.label_success_with_a_raise="Success with a raise",this.label_success_with_x_raises="Success with {raises} raises",this.label_die_roll_number="die roll #",this.label_wild_die_roll_number="wild die roll #",this.label_roll_set_number="Roll Set #",this.label_total_roll="Total Roll",this.success_target_number=4,this.success_base_toughness=5,this.success_armor=1,this.success_weapons_ap=0},roll_die:function(t,e,r){for(t||(t=6),total_roll=0,keep_rolling=1,display_roll="";keep_rolling>0;)roll=Math.floor(Math.random()*t)+1,e>0&&roll==t?keep_rolling=1:keep_rolling=0,display_roll+=roll+", ",total_roll+=roll;if(this.roll_set_count_rolls[this.roll_set_count].base_rolls.push(display_roll),this.roll_set_count_rolls[this.roll_set_count].base_roll_sides.push(t),wild_display_roll="",totalwild_dieRoll=0,keep_rolling=1,r>0)for(t=6;keep_rolling>0;)roll=Math.floor(Math.random()*t)+1,e>0&&roll==t?keep_rolling=1:keep_rolling=0,totalwild_dieRoll+=roll,wild_display_roll+=roll+", ";return this.roll_set_count_rolls[this.roll_set_count].wild_die_rolls.push(wild_display_roll),1==totalwild_dieRoll&&1==total_roll?this.roll_set_count_rolls[this.roll_set_count].critical_failure=1:this.roll_set_count_rolls[this.roll_set_count].critical_failure=0,totalwild_dieRoll>total_roll?totalwild_dieRoll:total_roll},roll_dice:function(t,e){var r=0;number_of_sides=6,t.indexOf("*")>0?wild_die=1:wild_die=0,number_of_sides<2&&(number_of_sides=2),t=t.replace("*",""),explodingDice=0,t.indexOf("d")>-1?(rollNumber=t.substring(0,t.indexOf("d"))/1,number_of_sides=t.substring(t.indexOf("d")+1)/1,this.always_exploding_dice&&(explodingDice=1)):t.indexOf("e")>-1?(explodingDice=1,rollNumber=t.substring(0,t.indexOf("e"))/1,number_of_sides=t.substring(t.indexOf("e")+1)/1):rollNumber=t,rollNumber||(rollNumber=1),number_of_sides||(number_of_sides=6);for(var a=rollNumber+"d"+number_of_sides+": ";rollNumber-- >0;)dieRoll=this.roll_die(number_of_sides,explodingDice,wild_die),r+=dieRoll,a+=dieRoll+",",this.roll_set_count_rolls[this.roll_set_count].total_rolled_dice++;return a=a.substring(0,a.length-1),a+="",r},_parse_bit:function(t){return value=0,t.indexOf("d")>-1?value=this.roll_dice(t,0):t.indexOf("e")>-1?value=this.roll_dice(t,0):value=t/1,value},_parse_roll_set:function(t){if(set_total=0,t=t.replace(/ /g,""),t=t.toLowerCase(),t=t.replace(/\+/g," + "),t=t.replace(/x/g," x "),t=t.replace(/\//g," / "),t=t.replace(/\-/g," - "),t=t.replace(/\)/g," ) "),t=t.replace(/\(/g," ( "),t=t.replace(/\,/g," , "),this.roll_set_count_rolls[this.roll_set_count]={},this.roll_set_count_rolls[this.roll_set_count].base_rolls=[],this.roll_set_count_rolls[this.roll_set_count].wild_die_rolls=[],this.roll_set_count_rolls[this.roll_set_count].base_roll_sides=[],this.roll_set_count_rolls[this.roll_set_count].total_rolled_dice=0,this.roll_set_count_rolls[this.roll_set_count].critical_failure=0,t.indexOf(" ")>0)for(items=t.split(" "),current_function="+",count=0;count<items.length;count++)"+"!=items[count]&&"x"!=items[count]&&"-"!=items[count]&&"/"!=items[count]?"+"==current_function?set_total+=this._parse_bit(items[count])/1:"-"==current_function?set_total-=this._parse_bit(items[count])/1:"x"==current_function?0==set_total?set_total=items[count]/1:set_total=set_total*this._parse_bit(items[count])/1:"/"==current_function&&(set_total=set_total/this._parse_bit(items[count])/1):current_function=items[count];else set_total+=this._parse_bit(t);this.roll_set_count_rolls[this.roll_set_count].total_roll=set_total,this.roll_set_count++},parse_roll:function(t){if(total=0,this.roll_set_count=0,this.roll_set_count_rolls=[],t.indexOf(",")>0)for(parse_roll_items=t.split(","),parse_roll_itemcount=0;parse_roll_itemcount<parse_roll_items.length;parse_roll_itemcount++)total=this._parse_roll_set(parse_roll_items[parse_roll_itemcount]);else total+=this._parse_roll_set(t);return total},display_results:function(t,e){for(html="",results_set_count=0;results_set_count<this.roll_set_count;results_set_count++)for(this.roll_set_count>1&&(results_set_count>0&&(html+="<hr />"),html+="<h4>"+this.label_roll_set_number+(results_set_count+1)+"</h4>"),html+="<h5>"+this.label_total_roll+": "+this.roll_set_count_rolls[results_set_count].total_roll+"</h5>",t&&(html+=this.trait_success_margin(this.roll_set_count_rolls[results_set_count].total_roll,null,results_set_count)+"<br />"),e&&(html+=this.damage_success_margin(this.roll_set_count_rolls[results_set_count].total_roll)+"<br />"),current_roll=0;current_roll<this.roll_set_count_rolls[results_set_count].total_rolled_dice;current_roll++)void 0!==this.roll_set_count_rolls[results_set_count].base_rolls[current_roll]&&(html+="<br />"+this.label_die_roll_number+(current_roll+1)+" (d"+this.roll_set_count_rolls[results_set_count].base_roll_sides[current_roll]+"): ",this.roll_set_count_rolls[results_set_count].base_rolls[current_roll]&&(this.roll_set_count_rolls[results_set_count].base_rolls[current_roll].length>2?html+=this.roll_set_count_rolls[results_set_count].base_rolls[current_roll].substring(0,this.roll_set_count_rolls[results_set_count].base_rolls[current_roll].length-2):html+=this.roll_set_count_rolls[results_set_count].base_rolls[current_roll])),void 0!==this.roll_set_count_rolls[results_set_count].wild_die_rolls[current_roll]&&(this.roll_set_count_rolls[results_set_count].wild_die_rolls[current_roll].length>0&&(html+="<br />"+this.label_wild_die_roll_number+(current_roll+1)+" (d6): "),this.roll_set_count_rolls[results_set_count].wild_die_rolls[current_roll]&&(this.roll_set_count_rolls[results_set_count].wild_die_rolls[current_roll].length>2?html+=this.roll_set_count_rolls[results_set_count].wild_die_rolls[current_roll].substring(0,this.roll_set_count_rolls[results_set_count].wild_die_rolls[current_roll].length-2):html+=this.roll_set_count_rolls[results_set_count].wild_die_rolls[current_roll]));return html},trait_success_margin:function(t,e,r){return e||(e=this.success_target_number),value=t/1-e/1,html="",void 0!==r&&this.roll_set_count_rolls[r].critical_failure>0?html+='<span  class="color-red bolded uppercase">'+this.label_critical_failure+"</span>":value<0?html+='<span  class="color-red">'+this.label_failure+"</span>":(raises=Math.floor(value/4),0==raises?html+=this.label_success:1==raises?html+='<span  class="color-green bolded">'+this.label_success_with_a_raise+"</span>":html+='<span  class="color-green bolded uppercase">'+this.label_success_with_x_raises.replace("{raises}",raises)+"</span>"),html},set_result_margins:function(t,e,r,a){this.success_target_number=t,this.success_base_toughness=e,this.success_armor=r,this.success_weapons_ap=a},set_label:function(t,e){return"no_effect"==t?(this.label_no_effect=e,e):"total_roll"==t?(this.label_total_roll=e,e):"shaken"==t?(this.label_shaken=e,e):"shaken_and_a_wound"==t?(this.label_shaken_and_a_wound=e,e):"shaken_and_x_wounds"==t?(this.label_shaken_and_x_wounds=e,e):"critical_failure"==t?(this.label_critical_failure=e,e):"roll_set_number"==t?(this.label_roll_set_number=e,e):"failure"==t?(this.label_failure=e,e):"success"==t?(this.label_success=e,e):"success_with_a_raise"==t?(this.label_success_with_a_raise=e,e):"success_with_x_raises"==t?(this.label_success_with_x_raises=e,e):"die_roll_number"==t?(this.label_die_roll_number=e,e):"wild_die_roll_number"==t?(this.label_wild_die_roll_number=e,e):null},set_always_exploding_dice:function(t){return this.always_exploding_dice=t,this.always_exploding_dice},damage_success_margin:function(t,e,r,a){return e||(e=this.success_base_toughness),r||(r=this.success_armor),a||(a=this.success_weapons_ap),(r=r/1-a/1)<0&&(r=0),target_number=e/1+r/1,value=t/1-target_number/1,html="",value<0?html+="<span>"+this.label_no_effect+"</span>":(raises=Math.floor(value/4),0==raises?html+='<span class="color-orange">'+this.label_shaken+"</span>":1==raises?html+='<span class="color-red">'+this.label_shaken_and_a_wound+"</span>":html+='<span class="color-red bolded uppercase">'+this.label_shaken_and_x_wounds.replace("{raises}",raises)+"</span>"),html}};var creditsArray=["$rootScope","$translate","$scope",function(t,e,r){e(["APP_TITLE","INDEX_WELCOME"]).then(function(e){t.title_tag=e.INDEX_WELCOME+" | "+e.APP_TITLE,t.subtitle_tag="&raquo; "+e.INDEX_CREDITS}),r.currentCreditsPage=!0,t.playerList=getPlayersFromLocalStorage(),t.tournamentList=getTournamentsFromLocalStorage();for(var a=0;a<t.tournamentList.length;a++)t.tournamentList[a].createPlayerObjs(t.playerList);r.currentTournament=null,t.tournamentList[localStorage.current_tournament_view]&&(r.currentTournament=t.tournamentList[localStorage.current_tournament_view])}];angular.module("webApp").controller("creditsController",creditsArray),angular.module("cordovaApp").controller("creditsController",creditsArray);var coreGlobalFunctions=function(t,e,r,a,o,n){e.updatePlayerFirstName=function(t){e.tmpPlayer.name.first=t},e.updatePlayerLastName=function(t){e.tmpPlayer.name.last=t},e.updatePlayerNickName=function(t){e.tmpPlayer.name.nick=t},e.updatePlayerActive=function(t){e.tmpPlayer.active=t},e.updatePlayerEmail=function(t){e.tmpPlayer.email=t},e.updatePlayerPhone1=function(t){e.tmpPlayer.phone1=t},e.newPlayerDialog=function(){e.clearTempPlayerData(),e.showEditPlayerDialog=!0},e.confirmDialogQuestion="",e.showImportExportPlayerDialog=!1,e.confirmDialog=function(t,r){e.confirmDialogQuestion=t,e.showConfirmDialog=!0,e.confirmDialogYes=r},e.closeConfirmDialog=function(){e.showConfirmDialog=!1,e.confirmDialogYes=function(){e.showConfirmDialog=!1}},e.deletePlayerDialog=function(t){r(["PLAYERS_DELETE_CONFIRMATION"]).then(function(r){e.confirmDialog(r.PLAYERS_DELETE_CONFIRMATION,function(){e.showConfirmDialog=!1;for(var r=0;r<e.playerList.length;r++)t==e.playerList[r].id&&(e.playerList[r].deleted=!0,savePlayersToLocalStorage(e.playerList),e.getNumberOfDeleted())})})},e.restorePlayerFromDelete=function(t){indexNumber=getPlayerIndexByID(e.playerList,t),e.playerList[indexNumber]?(e.playerList[indexNumber].deleted=!1,savePlayersToLocalStorage(e.playerList),e.getNumberOfDeleted()):console.log("ERROR","No playerID "+t+" found!")},e.editPlayerDialog=function(t){indexNumber=getPlayerIndexByID(e.playerList,t),e.playerList[indexNumber]&&(e.tmpPlayer=angular.copy(e.playerList[indexNumber]),e.tmpPlayerIndex=indexNumber,e.showEditPlayerDialog=!0)},e.clearTempPlayerData=function(){e.tmpPlayer=new Player,e.tmpPlayerIndex=-1},e.saveEditPlayerDialog=function(){e.showEditPlayerDialog=!1,e.tmpPlayerIndex>-1?(e.tmpPlayer.updated=new Date,e.tmpPlayer.id.length<10&&(e.tmpPlayer.id=generateUUID()),e.playerList[e.tmpPlayerIndex]=new Player(e.tmpPlayer)):(e.tmpPlayer.created=new Date,e.tmpPlayer.updated=new Date,e.playerList.push(new Player(e.tmpPlayer))),savePlayersToLocalStorage(e.playerList),e.getNumberOfDeleted(),e.clearTempPlayerData()},e.getNumberOfDeleted=function(){e.deletedPlayers=Array(),e.activePlayers=Array();for(var t=0;t<e.playerList.length;t++)e.playerList[t].deleted?e.deletedPlayers.push(e.playerList[t]):e.activePlayers.push(e.playerList[t]);e.numDeletedPlayers=e.deletedPlayers.length},e.closeEditPlayerDialog=function(){e.showEditPlayerDialog=!1,e.clearTempPlayerData()}};angular.module("webApp").run(["$timeout","$rootScope","$translate","$location","$route",coreGlobalFunctions]),angular.module("cordovaApp").run(["$timeout","$rootScope","$translate","$location","$route","$cordovaFile",coreGlobalFunctions]);var playersManageArray=["$rootScope","$translate","$scope","$http",function(t,e,r,a){e(["APP_TITLE","WELCOME_BUTTON_MANAGE_PLAYERS","GENERAL_FILTER_SEARCH_PLAYERS"]).then(function(e){t.title_tag=e.WELCOME_BUTTON_MANAGE_PLAYERS+" | "+e.APP_TITLE,t.subtitle_tag="&raquo; "+e.GENERAL_FILTER_SEARCH_PLAYERS,t.filterSearchPlayersPlaceholder=e.GENERAL_FILTER_SEARCH_PLAYERS}),r.filterSearchTerm="",r.currentPlayersPage=!0,t.playerList=getPlayersFromLocalStorage(),t.tournamentList=getTournamentsFromLocalStorage();for(var o=0;o<t.tournamentList.length;o++)t.tournamentList[o].createPlayerObjs(t.playerList);t.currentTournament=null,t.tournamentList[localStorage.current_tournament_view]&&(t.currentTournament=t.tournamentList[localStorage.current_tournament_view]),t.getNumberOfDeleted(),r.importExportPlayersDialog=function(){var t=JSON.stringify(r.playerList),e=new Blob([t],{type:"application/javascript"});r.downloadPlayerData=(window.URL||window.webkitURL).createObjectURL(e),r.showImportExportPlayerDialog=!0},r.closeImportExportPlayerDialog=function(){r.showImportExportPlayerDialog=!1},r.uploadFile=function(e){for(var a=new FileReader,o=0;o<e.length;o++){var n=e[o];a.onload=function(e){if(e.target&&e.target.result){var a=JSON.parse(e.target.result);if(playersUpdated=0,playersCreated=0,a){objectified=Array();for(var o=0;o<a.length;o++){var n=new Player(a[o]);playerIDExists=getPlayerIndexByID(t.playerList,n.id),playerIDExists>-1?r.importAsNewPlayers?(n.id=getNextPlayerID(t.playerList),objectified.push(n),playersCreated++):(t.playerList[playerIDExists]=n,playersUpdated++):(objectified.push(n),playersCreated++)}t.playerList=t.playerList.concat(objectified),savePlayersToLocalStorage(t.playerList),t.getNumberOfDeleted()}}},a.readAsText(n)}}}];angular.module("webApp").controller("controllerPlayersManage",playersManageArray),angular.module("cordovaApp").controller("controllerPlayersManage",playersManageArray);var tournamentsManageArray=["$rootScope","$translate","$location","$scope",function(t,e,r,a){e(["APP_TITLE","WELCOME_BUTTON_MANAGE_TOURNAMENTS","TOURNAMENTS_MATCHUP_HIGHEST_RANKING","TOURNAMENTS_MATCHUP_RANDOM","GENERAL_FILTER_SEARCH_PLAYERS"]).then(function(e){t.title_tag=e.WELCOME_BUTTON_MANAGE_TOURNAMENTS+" | "+e.APP_TITLE,t.subtitle_tag="&raquo; "+e.WELCOME_BUTTON_MANAGE_TOURNAMENTS,t.filterSearchPlayersPlaceholder=e.GENERAL_FILTER_SEARCH_PLAYERS,a.tournamentMatchupOptions=Array(),a.filterSearchTerm="",a.tournamentMatchupOptions.push({id:"highest-ranking",label:e.TOURNAMENTS_MATCHUP_HIGHEST_RANKING}),a.tournamentMatchupOptions.push({id:"random",label:e.TOURNAMENTS_MATCHUP_RANDOM}),a.tmpMatchupSelection=a.tournamentMatchupOptions[0]}),a.currentTournamentsPage=!0,a.refreshTournamentData=function(){t.playerList=getPlayersFromLocalStorage(),t.tournamentList=getTournamentsFromLocalStorage();for(var e=0;e<t.tournamentList.length;e++)t.tournamentList[e].createPlayerObjs(t.playerList)},a.refreshTournamentData(),t.currentTournament=null,t.tournamentList[localStorage.current_tournament_view]&&(t.currentTournament=t.tournamentList[localStorage.current_tournament_view],(0==t.currentTournament.playerObjs.length||t.currentTournament.completed)&&(t.currentTournament=null)),a.confirmDialogQuestion="",a.showImportExportTournamentDialog=!1,a.confirmDialog=function(t,e){a.confirmDialogQuestion=t,a.showConfirmDialog=!0,a.confirmDialogYes=e},a.closeConfirmDialog=function(){a.showConfirmDialog=!1,a.confirmDialogYes=function(){a.showConfirmDialog=!1}},a.updateTournamentName=function(e){t.tmpTournament.name=e},a.updateTournamentRounds=function(e){t.tmpTournament.numberOfRounds=e},a.updateTournamentPointsForWin=function(e){t.tmpTournament.pointsForWin=e},a.updateTournamentPointsForDraw=function(e){t.tmpTournament.pointsForDraw=e},a.updateTournamentPointsForLoss=function(e){t.tmpTournament.pointsForLoss=e},a.updateByeIsAverage=function(e){t.tmpTournament.byeIsAverage=e},a.updateTournamentPointsForBye=function(e){t.tmpTournament.pointsForBye=e},a.updateTournamentScoringPaint=function(e){t.tmpTournament.scoringPaint=e},a.updateTournamentScoringComp=function(e){t.tmpTournament.scoringComp=e},a.updateTournamentScoringSportsmanship=function(e){t.tmpTournament.scoringSportsmanship=e},a.updateTournamentTrackPerGameSportsmanship=function(e){t.tmpTournament.trackPerGameSportsmanship=e},a.updateTournamentWarnSportsmanship=function(e){t.tmpTournament.warnSportsmanship=e},a.newTournamentDialog=function(){a.clearTempTournamentData(),a.getMatchupSelection(t.tmpTournament.matchupType),a.showEditTournamentDialog=!0},a.updateTmpMatchupSelection=function(t){a.tmpMatchupSelection=t},a.updateNoDuplicateMatchups=function(e){t.tmpTournament.noDuplicateMatchups=e},a.deleteTournamentDialog=function(r){e(["TOURNAMENTS_DELETE_CONFIRMATION"]).then(function(e){a.confirmDialog(e.TOURNAMENTS_DELETE_CONFIRMATION,function(){a.showConfirmDialog=!1,t.tournamentList.splice(r,1),saveTournamentsToLocalStorage(t.tournamentList,t.playerList)})})},a.editTournamentDialog=function(e){t.tournamentList[e]&&(t.tmpTournament=angular.copy(t.tournamentList[e]),a.getMatchupSelection(t.tmpTournament.matchupType),t.tmpTournamentIndex=e,a.showEditTournamentDialog=!0)},a.clearTempTournamentData=function(){t.tmpTournament=new Tournament,a.getMatchupSelection(t.tmpTournament.matchupType),t.tmpTournamentIndex=-1},a.getMatchupSelection=function(t){a.tmpMatchupSelection=a.tournamentMatchupOptions[0];for(var e=0;e<a.tournamentMatchupOptions.length;e++)a.tournamentMatchupOptions[e].id==t&&(a.tmpMatchupSelection=a.tournamentMatchupOptions[e])},a.saveEditTournamentDialog=function(){a.showEditTournamentDialog=!1,t.tmpTournament.matchupType=a.tmpMatchupSelection.id,t.tmpTournamentIndex>-1?(t.tmpTournament.updated=new Date,t.tournamentList[t.tmpTournamentIndex]=t.tmpTournament,saveTournamentsToLocalStorage(t.tournamentList,t.playerList),a.clearTempTournamentData()):(newID=getNextPlayerID(t.playerList),t.tmpTournament.created=new Date,t.tmpTournament.updated=new Date,t.tournamentList.id=newID,t.tournamentList.push(t.tmpTournament),saveTournamentsToLocalStorage(t.tournamentList,t.playerList),a.clearTempTournamentData(),a.editTournamentPlayersDialog(t.tournamentList.length-1))},a.closeEditTournamentDialog=function(){a.showEditTournamentDialog=!1,a.clearTempTournamentData()},a.showTournamentResults=function(t){alert("showTournamentResults("+t+") called - TODO")},a.showTournamentPage=function(t){localStorage.current_tournament_view=t,r.path("tournaments-run")},a.addPlayerToTournament=function(e){t.tmpTournament.players.push(e),t.tmpTournament.createPlayerObjs(a.playerList),saveTournamentsToLocalStorage(t.tournamentList,t.playerList),a.updateAvailableParticipatingPlayers()},a.removePlayerFromTournament=function(e){for(var r=0;r<t.tmpTournament.players.length;r++)t.tmpTournament.players[r]==e&&(t.tmpTournament.players.splice(r,1),saveTournamentsToLocalStorage(t.tournamentList,t.playerList),a.updateAvailableParticipatingPlayers())},a.updateAvailableParticipatingPlayers=function(){a.availablePlayers=Array(),a.participatingPlayers=angular.copy(t.tmpTournament.playerObjs);for(var e=0;e<a.playerList.length;e++)-1===t.tmpTournament.players.indexOf(a.playerList[e].id)&&1==a.playerList[e].active&&0==a.playerList[e].deleted&&a.availablePlayers.push(a.playerList[e]);a.availablePlayers.sort(sortByNames),a.participatingPlayers.sort(sortByNames)},a.showEditTournamentPlayersDialog=!1,a.editTournamentPlayersDialog=function(e){t.tmpTournament=t.tournamentList[e],a.updateAvailableParticipatingPlayers(),a.showEditTournamentPlayersDialog=!0},a.closeTournamentPlayersDialog=function(){a.showEditTournamentPlayersDialog=!1,t.tmpTournament=null},a.importExportTournamentsDialog=function(){for(var t=a.tournamentList,e=0;e<t.length;e++)delete t[e].playerObjs;var r=JSON.stringify(t),o=new Blob([r],{type:"application/javascript"});a.downloadTournamentData=(window.URL||window.webkitURL).createObjectURL(o),a.showImportExportTournamentDialog=!0},a.closeImportExportTournamentDialog=function(){a.showImportExportTournamentDialog=!1},a.uploadFile=function(e){for(var r=new FileReader,a=0;a<e.length;a++){var o=e[a];r.onload=function(e){if(e.target&&e.target.result){var r=JSON.parse(e.target.result);if(r){objectified=Array();for(var a=0;a<r.length;a++){var o=new Tournament(r[a]);objectified.push(o)}t.tournamentList=t.tournamentList.concat(objectified),saveTournamentsToLocalStorage(t.tournamentList,t.playerList)}}},r.readAsText(o)}}}];angular.module("webApp").controller("controllerTourmamentsManage",tournamentsManageArray),angular.module("cordovaApp").controller("controllerTourmamentsManage",tournamentsManageArray);var tournamentsRunArray=["$rootScope","$translate","$location","$scope","$route",function(t,e,r,a,o){e(["APP_TITLE","WELCOME_BUTTON_MANAGE_TOURNAMENTS"]).then(function(e){t.title_tag=e.WELCOME_BUTTON_MANAGE_TOURNAMENTS+" | "+e.APP_TITLE,t.subtitle_tag="&raquo; "+e.WELCOME_BUTTON_MANAGE_TOURNAMENTS}),t.currentTournamentsRun=!0,t.tmpMatchupSwappingID="",t.playerList=getPlayersFromLocalStorage(),t.tournamentList=getTournamentsFromLocalStorage();for(var n=0;n<t.tournamentList.length;n++)t.tournamentList[n].createPlayerObjs(t.playerList);t.currentTournament=null,t.tournamentList[localStorage.current_tournament_view]&&(t.currentTournament=t.tournamentList[localStorage.current_tournament_view],t.currentTournament.calculateResults()),a.editScore=function(e,r){var o=t.currentTournament.getMatch(r,e);t.tmpPlayer1Score=-1,t.tmpPlayer1Score=-1,t.tmpPlayer1ExtraPoints=0,t.tmpPlayer2ExtraPoints=0,t.tmpPlayer1SteamArmyPoints=0,t.tmpPlayer1SteamControlPoints=0,t.tmpPlayer2SteamArmyPoints=0,t.tmpPlayer2SteamControlPoints=0,a.editScorePlayer1=getPlayerByID(a.playerList,o.player1),a.editScorePlayer2=getPlayerByID(a.playerList,o.player2),t.tmpPlayer1Score=t.currentTournament.getScore(r,o.player1),t.tmpPlayer2Score=t.currentTournament.getScore(r,o.player2),t.tmpPlayer1ExtraPoints=t.currentTournament.getExtraPoints(r,o.player1),t.tmpPlayer2ExtraPoints=t.currentTournament.getExtraPoints(r,o.player2),t.tmpPlayer1SteamArmyPoints=t.currentTournament.getSteamArmyPoints(r,o.player1),t.tmpPlayer1SteamControlPoints=t.currentTournament.getSteamControlPoints(r,o.player1),t.tmpPlayer2SteamArmyPoints=t.currentTournament.getSteamArmyPoints(r,o.player2),t.tmpPlayer2SteamControlPoints=t.currentTournament.getSteamControlPoints(r,o.player2),a.editRoundNumber=r,a.editTableNumber=o.table,a.showEditScoreDialog=!0},a.changePlayerScore=function(e,r){1==e?(t.tmpPlayer1Score=r,t.tmpPlayer2Score="win"==r?"loss":"draw"==r?"draw":"loss"==r?"win":"-1"):(t.tmpPlayer2Score=r,t.tmpPlayer1Score="win"==r?"loss":"draw"==r?"draw":"loss"==r?"win":"-1")},a.changePlayerExtraPoints=function(e,r){1==e?t.tmpPlayer1ExtraPoints=r:t.tmpPlayer2ExtraPoints=r},a.changeSteamControlPoints=function(e,r){1==e?t.tmpPlayer1SteamControlPoints=r:t.tmpPlayer2SteamControlPoints=r},a.changeSteamArmyPoints=function(e,r){1==e?t.tmpPlayer1SteamArmyPoints=r:t.tmpPlayer2SteamArmyPoints=r},a.cancelEditScoreDialog=function(){a.showEditScoreDialog=!1,a.editScorePlayer1=null,a.editScorePlayer2=null,t.tmpPlayer1Score=-1,t.tmpPlayer1Score=-1,t.tmpPlayer1ExtraPoints=0,t.tmpPlayer2ExtraPoints=0,t.tmpPlayer1SteamArmyPoints=0,t.tmpPlayer1SteamControlPoints=0,t.tmpPlayer2SteamArmyPoints=0,t.tmpPlayer2SteamControlPoints=0,a.editRoundNumber=-1,a.editTableNumber=-1,o.reload()},a.saveEditScoreDialog=function(){t.currentTournament.setScore(a.editRoundNumber,a.editScorePlayer1.id,t.tmpPlayer1Score),t.currentTournament.setScore(a.editRoundNumber,a.editScorePlayer2.id,t.tmpPlayer2Score),t.currentTournament.setExtraPoints(a.editRoundNumber,a.editScorePlayer1.id,t.tmpPlayer1ExtraPoints),t.currentTournament.setExtraPoints(a.editRoundNumber,a.editScorePlayer2.id,t.tmpPlayer2ExtraPoints),t.currentTournament.setSteamArmyPoints(a.editRoundNumber,a.editScorePlayer1.id,t.tmpPlayer1SteamArmyPoints),t.currentTournament.setSteamArmyPoints(a.editRoundNumber,a.editScorePlayer2.id,t.tmpPlayer2SteamArmyPoints),t.currentTournament.setSteamControlPoints(a.editRoundNumber,a.editScorePlayer1.id,t.tmpPlayer1SteamControlPoints),t.currentTournament.setSteamControlPoints(a.editRoundNumber,a.editScorePlayer2.id,t.tmpPlayer2SteamControlPoints),t.currentTournament.calculateResults(),saveTournamentsToLocalStorage(t.tournamentList,t.playerList),a.showEditScoreDialog=!1,a.editScorePlayer1=null,a.editScorePlayer2=null,t.tmpPlayer1Score=-1,t.tmpPlayer1Score=-1,t.tmpPlayer1ExtraPoints=0,t.tmpPlayer2ExtraPoints=0,t.tmpPlayer1SteamArmyPoints=0,t.tmpPlayer1SteamArmyPoints=0,t.tmpPlayer2SteamArmyPoints=0,t.tmpPlayer2SteamControlPoints=0,a.editRoundNumber=-1,a.editTableNumber=-1,t.currentTournament.sortPlayerObjsByScores(),o.reload()},a.editPaintingScore=function(e){t.tmpEditPlayer=Array(),t.tmpEditExtraPointValue=0,t.tmpEditPlayer=getPlayerByID(a.playerList,e),t.tmpEditExtraPointValue=t.currentTournament.getPaintingPoints(e),t.tmpEditExtraPointValue<0&&(t.tmpEditExtraPointValue=0),a.showEditPaintScore=!0},a.editCompositionScore=function(e){t.tmpEditPlayer=Array(),t.tmpEditExtraPointValue=0,t.tmpEditPlayer=getPlayerByID(a.playerList,e),t.tmpEditExtraPointValue=t.currentTournament.getCompPoints(e),t.tmpEditExtraPointValue<0&&(t.tmpEditExtraPointValue=0),a.showEditCompScore=!0},a.editSportsmanshipScore=function(e){t.tmpEditPlayer=Array(),t.tmpEditExtraPointValue=0,t.tmpEditPlayer=getPlayerByID(a.playerList,e),t.tmpEditExtraPointValue=t.currentTournament.getSportsPoints(e),t.tmpEditExtraPointValue<0&&(t.tmpEditExtraPointValue=0),a.showEditSportsScore=!0},a.saveSportsScore=function(){t.currentTournament.setSportsPoints(t.tmpEditPlayer.id,t.tmpEditExtraPointValue),saveTournamentsToLocalStorage(t.tournamentList,t.playerList),t.currentTournament.calculateResults(),a.cancelEditScore()},a.saveCompScore=function(){t.currentTournament.setCompPoints(t.tmpEditPlayer.id,t.tmpEditExtraPointValue),saveTournamentsToLocalStorage(t.tournamentList,t.playerList),t.currentTournament.calculateResults(),a.cancelEditScore()},a.savePaintScore=function(){t.currentTournament.setPaintingPoints(t.tmpEditPlayer.id,t.tmpEditExtraPointValue),saveTournamentsToLocalStorage(t.tournamentList,t.playerList),t.currentTournament.calculateResults(),a.cancelEditScore()},a.changeExtraBitsScore=function(e){t.tmpEditExtraPointValue=e},a.cancelEditScore=function(){t.tmpEditPlayer=null,t.tmpEditExtraPointValue=null,a.showEditPaintScore=!1,a.showEditCompScore=!1,a.showEditSportsScore=!1},a.closeCurrentTournament=function(){t.currentTournament=null,localStorage.current_tournament_view=-1,r.path("tournaments-manage")},a.setupNextRound=function(){t.currentTournament.createMatchRound(t.currentTournament.currentRound+1,a.playerList),a.playerMatchupDialog=!0},a.closePlayerMatchupDialog=function(){a.playerMatchupDialog=!1},a.resetMatchups=function(){t.currentTournament.createMatchRound(t.currentTournament.currentRound+1,a.playerList)},a.swapPlayerButton=function(e){t.tmpMatchupSwappingID?(t.currentTournament.swapPlayers(t.tmpMatchupSwappingID,e,t.currentTournament.currentRound+1,a.playerList),t.tmpMatchupSwappingID=""):t.tmpMatchupSwappingID=e},a.cancelSwap=function(){t.tmpMatchupSwappingID=""},a.completeTournament=function(){t.currentTournament.completed=!0,saveTournamentsToLocalStorage(t.tournamentList,t.playerList)},a.startNextRound=function(){t.currentTournament.currentRound++,saveTournamentsToLocalStorage(t.tournamentList,t.playerList),a.playerMatchupDialog=!1}}];angular.module("webApp").controller("controllerTourmamentsRun",tournamentsRunArray),angular.module("cordovaApp").controller("controllerTourmamentsRun",tournamentsRunArray);var settingsArray=["$rootScope","$translate","$scope","$route",function(t,e,r,a){e(["APP_TITLE","GENERAL_SETTINGS"]).then(function(e){t.title_tag=e.GENERAL_SETTINGS+" | "+e.APP_TITLE,t.subtitle_tag=e.GENERAL_SETTINGS}),r.currentSettingsPage=!0,t.playerList=getPlayersFromLocalStorage(),t.tournamentList=getTournamentsFromLocalStorage();for(var o=0;o<t.tournamentList.length;o++)t.tournamentList[o].createPlayerObjs(t.playerList);for(r.currentTournament=null,t.tournamentList[localStorage.current_tournament_view]&&(r.currentTournament=t.tournamentList[localStorage.current_tournament_view]),r.available_languages=Array(),r.users_language={},lang_count=0;lang_count<available_languages.length;lang_count++)available_languages[lang_count].active&&(language_object={id:available_languages[lang_count].short_code,label:available_languages[lang_count].native_name},r.available_languages.push(language_object),localStorage.users_preferred_language==available_languages[lang_count].short_code&&(r.users_language=language_object,r.background_image_url="url(images/flags/64/"+available_languages[lang_count].icon_file+")"));r.chargen_pdf_layout=localStorage.users_chargen_pdf_layout,r.updateLanguage=function(t){for(e.use(r.users_language.id),localStorage.users_preferred_language=r.users_language.id,lang_count=0;lang_count<available_languages.length;lang_count++)available_languages[lang_count].active&&localStorage.users_preferred_language==available_languages[lang_count].short_code&&(r.background_image_url="url(images/flags/64/"+available_languages[lang_count].icon_file+")");a.reload()},r.updateChargenPDF=function(t){localStorage.users_chargen_pdf_layout=t,r.chargen_pdf_layout=t,a.reload()}}];angular.module("webApp").controller("settingsController",settingsArray),angular.module("cordovaApp").controller("settingsController",settingsArray);var welcomeArray=["$rootScope","$translate","$scope",function(t,e,r){e(["APP_TITLE","INDEX_WELCOME"]).then(function(e){t.title_tag=e.INDEX_WELCOME+" | "+e.APP_TITLE,t.subtitle_tag="&raquo; "+e.INDEX_WELCOME}),r.currentWelcomePage=!0,t.playerList=getPlayersFromLocalStorage(),t.tournamentList=getTournamentsFromLocalStorage();for(var a=0;a<t.tournamentList.length;a++)t.tournamentList[a].createPlayerObjs(t.playerList);r.currentTournament=null,t.tournamentList[localStorage.current_tournament_view]&&(r.currentTournament=t.tournamentList[localStorage.current_tournament_view])}];angular.module("webApp").controller("welcomeController",welcomeArray),angular.module("cordovaApp").controller("welcomeController",welcomeArray),available_languages.push({english_name:"German",native_name:"Deutsch",icon_file:"DE.png",short_code:"de-DE",active:!0,translations:{}}),available_languages.push({english_name:"English",native_name:"English",icon_file:"US.png",short_code:"en-US",active:!0,translations:{APP_TITLE:"Tournament Tracker",INDEX_WELCOME:"Welcome",INDEX_H3_CORE:"Tournament Tracker",MENU_TITLE_HOME:"Click here to go home",MENU_TITLE_MANAGE_PLAYERS:"Click here go to player management",MENU_TITLE_MANAGE_TOURNAMENTS:"Click here to go to tournament management",MENU_TITLE_SETTINGS:"Click here to change settings",MENU_TITLE_CREDITS:"Click here to view the credits and help",MENU_TITLE_EXPORT_PLAYERS:"Click here to import and/or export players",MENU_TITLE_ADD_PLAYER:"Click here to add a player",MENU_TITLE_EXPORT_TOURNAMENTS:"Click here to import and/or export tournaments",MENU_TITLE_ADD_TOURNAMENT:"Click here to add a tournament",MENU_TITLE_CURRENT_TOURNAMENT:"Click here to return to your in-progress tournament",GENERAL_SELECT_LANGUAGE:"Select Langage",GENERAL_SETTINGS:"Settings",GENERAL_CREDITS:"Credits",GENERAL_COPYRIGHT:"Copyright",GENERAL_WELCOME:"Welcome",GENERAL_POINTS:"Points",GENERAL_POINT:"Point",GENERAL_POINT_VALUE:"Point Value",GENERAL_RULES:"Rules",GENERAL_GROUP:"Group",GENERAL_SKILL:"Skill",GENERAL_NAME:"Name",GENERAL_ALL:"All",GENERAL_SEARCH:"Search",GENERAL_SEARCH_RESULTS:"Search Results",GENERAL_CANCEL:"Cancel",GENERAL_ACTIVE:"Active",GENERAL_DOWNLOAD:"Download",GENERAL_IMPORT:"Import",GENERAL_EXPORT:"Export",GENERAL_SAVE:"Save",GENERAL_ADD:"Add",GENERAL_PLAYER:"Player",GENERAL_ITEM_RESTORE:"Restore",GENERAL_BYE:"Bye",GENERAL_TOTAL:"Total",GENERAL_FILTER_SEARCH_PLAYERS:"Filter/Search Players",GENERAL_ITEM_EDIT:"Edit Item",GENERAL_ITEM_REMOVE:"Remove Item",GENERAL_YES:"Yes",GENERAL_NO:"No",GENERAL_SAVE:"Save",GENERAL_CLOSE:"Close",GENERAL_NAME_FIRST:"First Name",GENERAL_NAME_LAST:"Last Name",GENERAL_NAME_NICK:"Nickname",GENERAL_PHONE:"Phone",GENERAL_PHONE_NUMBER:"Phone NUmber",GENERAL_EMAIL:"Email",GENERAL_EMAIL_ADDRESS:"Email Address",GENERAL_IMPORT_EXPORT_EXPLANATION:"Use this import/export function to transfer data from one device to another.",GENERAL_INTRODUCTORY:"Introductory",GENERAL_STANDARD:"Standard",GENERAL_ADVANCED:"Advanced",GENERAL_CLOSE:"Close",GENERAL_ERROR:"Error",GENERAL_CREATED:"Created",GENERAL_UPDATED:"Updated",GENERAL_FINISHED:"Finished",GENERAL_FINISHED:"Deleted",GENERAL_ID:"ID",GENERAL_ROUND:"Round",GENERAL_RESET:"Reset",GENERAL_NOT_ENTERED:"Not Entered",GENERAL_WIN:"Win",GENERAL_DRAW:"Draw",GENERAL_LOSS:"Loss",GENERAL_ROTATE_TO_LANDSCAPE:"Please rotate your device to landscape for optimal viewing",BUTTON_LANG_EN:"English",BUTTON_LANG_DE:"German",BUTTON_LANG_BR:"Brazilian",GENERAL_BYE_FIRST:"First",GENERAL_BYE_MIDDLE:"Middle",GENERAL_BYE_RANDOM:"Random",GENERAL_BYE_LAST:"Last",PLAYERS_DELETE_CONFIRMATION:"Are you sure you want to delete this player?",PLAYERS_IMPORT_INSTRUCTIONS:"To import players into this app, navigate to your Players.json file you have saved.",PLAYERS_DOWNLOAD_INSTRUCTIONS:"Click on the button below to download the current Players data object",PLAYERS_RETURN_TO_MANAGE:"Return to Player Management",PLAYERS_DELETED_PLAYERS:"Deleted Players",PLAYERS_NO_PLAYERS:"There are no players here. Add one by pressing the + at the top of the screen.",PLAYERS_NO_DELETED_PLAYERS:"There are no deleted players",PLAYERS_IMPORT_OVERWRITE_INSTRUCTIONS:"If you have an import file with existing Player IDs, then check here to create new IDs for players in the import file.<br /><strong>Warning</strong>: If you do not check this, any existing Player IDs in the import file will overwrite your existing Player Data.",TOURNAMENTS_DELETE_CONFIRMATION:"Are you sure you want to delete this tournament?",TOURNAMENTS_IMPORT_INSTRUCTIONS:"To import tournaments into this app, navigate to your Tournaments.json file you have saved. <strong>Be sure that your Players.json and Tournaments.json match, otherwise you may have orphan or wrong players!</strong>",TOURNAMENTS_TYPE:"Tournament Type",TOURNAMENTS_DOWNLOAD_INSTRUCTIONS:"Click on the button below to download the current Tournaments data object",TOURNAMENTS_NAME:"Tournament Name",TOURNAMENTS_NUM_PLAYERS:"# Players",TOURNAMENTS_EDIT_PLAYERS:"Edit Players",TOURNAMENTS_BASE_SCORING:"Base Scoring",TOURNAMENTS_EXTRA_SCORING:"Extra Scoring",TOURNAMENTS_BYE_OPTIONS:"Bye Options",TOURNAMENT_CONTROL_POINTS:"Control Points",TOURNAMENT_ARMY_POINTS:"Army Points",TOURNAMENTS_MATCHUP_SETTINGS:"Matchup Settings",TOURNAMENTS_MATCHUP_ORDERING:"Matchup Ordering",TOURNAMENTS_MATCHUP_NO_DUPLICATES:"No duplicate matchups, if possible",TOURNAMENTS_MATCHUP_HIGHEST_RANKING:"Highest Ranking",TOURNAMENTS_MATCHUP_RANDOM:"Random",TOURNAMENTS_WHO_GETS_THE_BYE:"Who gets the bye?",TOURNAMENTS_SWISS:"Swiss",TOURNAMENTS_STEAMROLLER:"Steamroller",TOURNAMENTS_STEAMROLLER_NO_OPTIONS:"Privateer Press's Steamroller 2016 is quite illicit on how many rounds, how to score, etc. Thankfully because of this, there are no options. Just press the Add button below to add players.",TOURNAMENTS_PLAYERS:"Players",TOURNAMENT_SWAP_LOG:"Automatic Player Swap Log",TOURNAMENTS_GENERAL_SETTINGS:"General Settings",TOURNAMENTS_POINTS_FOR_WIN:"Points for Win",TOURNAMENTS_POINTS_FOR_DRAW:"Points for Draw",TOURNAMENTS_POINTS_FOR_LOSS:"Points for Loss",TOURNAMENTS_POINTS_FOR_BYE:"Points for Bye",TOURNAMENTS_BYE_IS_AVERAGE:"Bye is Average",TOURNAMENTS_SCORING_PAINT:"Score Painting",TOURNAMENTS_SCORING_COMP:"Score Army Composition",TOURNAMENTS_SCORING_SPORTSMANSHIP:"Score Sportsmanship",TOURNAMENTS_SPORTSMANSHIP_PER_GAME:"Sportsmanship tracked per game",TOURNAMENTS_SPORTSMANSHIP_WARN:"Warn if Player receives the following number of negative sportsmanship marks",TOURNAMENTS_PLAYERS_PARTCIPATING:"Participating Players",TOURNAMENTS_PLAYERS_AVAILABLE:"Available Players",TOURNAMENTS_GO_TO_PLAYERS:"Go To Players",TOURNAMENTS_NO_AVAILABLE_PLAYERS:"There are no available players to add. Please visit the Player Adminsitration screen to add players.",TOURNAMENTS_NO_PLAYERS:"There are no players in this tournament",TOURNAMENTS_NUMBER_OF_ROUNDS:"Number of Rounds",TOURNAMENTS_NO_TOURNAMENTS:"There are no tournaments here. Add one by pressing the + at the top of the screen.",TOURNAMENT_IN_PLAY:"Tournament In-Play",TOURNAMENT_NO_CURRENT_TOURNAMENT:"For some reason the tournament that you're trying to reach has been either removed or moved on this device. Please select the Tournament icon above then 'play' an existing tournament",TOURNAMENT_BASE_SCORE:"Base Score",TOURNAMENT_FINAL_SCORE:"Final Score",TOURNAMENT_PAINTING_SCORE:"Painting Score",TOURNAMENT_COMPOSITION_SCORE:"Comp Score",TOURNAMENT_SPORTSMANSHIP_SCORE:"Sports Score",TOURNAMENT_EDIT_PAINTING_SCORE:"Editing Painting Score",TOURNAMENT_EDIT_COMPOSITION_SCORE:"Editing Comp Score",TOURNAMENT_EDIT_SPORTSMANSHIP_SCORE:"Editing Sports Score",TOURNAMENT_CURRENT_ROUND:"Current Round:",TOURNAMENT_NA:"n/a",TOURNAMENT_NE:"n/e",TOURNAMENT_NOT_AVAILABLE:"not available",TOURNAMENT_NOT_ENTERED:"not entered",TOURNAMENTS_FINISHED:"Finished",TOURNAMENTS_ROUND_NO:"Round #",TOURNAMENT_PRE_SETUP:"Pre-Setup",TOURNAMENT_FINAL_ROUND:"Final Round",TOURNAMENT_START_FIRST_ROUND:"Start First Round",TOURNAMENT_START_NEXT_ROUND:"Start Next Round",TOURNAMENT_START_LAST_ROUND:"Start Last Round",TOURNAMENT_ROUND_MATCHUPS:"Round Matchups",TOURNAMENT_TABLE_NUMBER:"Table Number",TOURNAMENT_PLAYER_1:"Player 1",TOURNAMENT_PLAYER_2:"Player 2",TOURNAMENT_START_ROUND:"Start Next Round",TOURNAMENT_CLOSE_TOURNAMENT:"Close Tournament",TOURNAMENT_COMPLETE_TOURNAMENT:"Complete Tournament",TOURNAMENT_GAME_IS_BYE:"Game is a bye",TOURNAMENT_START_FINAL_ROUND:"Start Final Round",TOURNAMENT_EDITING_GAME_SCORES:"Editing Game Scores",TOURNAMENT_EXTRA_POINTS:"Extra Points",TOURNAMENT_SWAP:"Swap",TOURNAMENT_SWAPPING:"Swapping",TOURNAMENT_SWAP_WITH:"Swap With",TOURNAMENT_CHOOSE_PLAYER_TO_SWAP:"Choose a player to swap with.",TOURNAMENT_CANCEL_SWAP:"Cancel Swap Mode",WELCOME_BUTTON_MANAGE_PLAYERS:"Manage Players",WELCOME_BUTTON_MANAGE_PLAYERS_DESC:"Before you can actually set up a tournament, you'll probably need to add some players here.",WELCOME_BUTTON_MANAGE_TOURNAMENTS:"Manage Tournaments",WELCOME_BUTTON_MANAGE_TOURNAMENTS_DESC:"In this area you'll find your past tournaments you've tracked on this device."}});
//# sourceMappingURL=sourcemap.map